DECLARE
	PROCEDURE ADD_SYSTEM_USER
		(
		p_USER_NAME IN VARCHAR2,
		p_USER_ID IN NUMBER,
		p_USER_DISPLAY_NAME IN VARCHAR2,
		p_ROLE_ID IN NUMBER DEFAULT NULL
		) AS
		v_COUNT BINARY_INTEGER;
	BEGIN
		SELECT COUNT(1)
		INTO v_COUNT
		FROM APPLICATION_USER
		WHERE USER_NAME = p_USER_NAME;

		--Add the user if it does not exist.
		IF v_COUNT = 0 THEN
			INSERT INTO APPLICATION_USER(USER_ID, USER_NAME, USER_DISPLAY_NAME, EMAIL_ADDR, IS_DISABLED, IS_SYSTEM_USER, ENTRY_DATE)
			VALUES(p_USER_ID, p_USER_NAME, p_USER_DISPLAY_NAME, NULL, 0, 1, SYSDATE);
			
			--Set the user's role only if it did not exist before.
			IF p_ROLE_ID IS NOT NULL THEN
				INSERT INTO APPLICATION_USER_ROLE (USER_ID, ROLE_ID, ENTRY_DATE) VALUES (p_USER_ID, p_ROLE_ID, SYSDATE);
			END IF;
		END IF;
		
	END ADD_SYSTEM_USER;
	
BEGIN
	ADD_SYSTEM_USER(SECURITY_CONTROLS.c_SUSER_SYSTEM, SECURITY_CONTROLS.c_SUSER_ID_SYSTEM, 'System', SECURITY_CONTROLS.g_SUPER_USER_ROLE_ID);	
	ADD_SYSTEM_USER(SECURITY_CONTROLS.c_SUSER_MAIL_MONITOR, SECURITY_CONTROLS.c_SUSER_ID_MAIL_MONITOR, 'Mail Monitor');	
	ADD_SYSTEM_USER(SECURITY_CONTROLS.c_SUSER_REACTOR, SECURITY_CONTROLS.c_SUSER_ID_REACTOR, 'Reactor', SECURITY_CONTROLS.g_SUPER_USER_ROLE_ID);
	ADD_SYSTEM_USER(SECURITY_CONTROLS.c_SUSER_PS_QUEUES_MONITOR, SECURITY_CONTROLS.c_SUSER_ID_PS_QUEUES_MONITOR, 'Process Queues Monitor');
END;
/
