CREATE OR REPLACE VIEW ACCOUNT_MODEL_BILLED_USAGE ( ACCOUNT, 
ACCOUNT_ID, METER_TYPE, BEGIN_DATE, END_DATE, 
BILLED_USAGE, METERED_USAGE, DELTA_USAGE, ENTRY_DATE
 ) AS SELECT A.ACCOUNT_NAME, 
	A.ACCOUNT_ID "ACCOUNT", 
	A.ACCOUNT_METER_TYPE "METER_TYPE", 
	B.BEGIN_DATE, 
	B.END_DATE, 
	NVL(B.BILLED_USAGE,0) "BILLED_USAGE", 
	NVL(B.METERED_USAGE,0) "METERED_USAGE", 
	NVL(B.BILLED_USAGE,0) - NVL(B.METERED_USAGE,0) "DELTA_USAGE", 
	B.ENTRY_DATE 
FROM RETAIL_ACCOUNT A, 
	ACCOUNT_BILLED_USAGE B 
WHERE SUBSTR(A.ACCOUNT_MODEL_OPTION,1,1) = 'A' 
	AND B.ACCOUNT_ID = A.ACCOUNT_ID;

