CREATE OR REPLACE VIEW SYSTEM_LOAD_AGGREGATE ( SYSTEM_LOAD_ID, 
LOAD_DATE, LOAD_CODE, LOAD_VAL ) AS SELECT A.SYSTEM_LOAD_ID, 
		B.LOAD_DATE, 
		B.LOAD_CODE, 
		SUM(DECODE(A.OPERATION_CODE,'S',-1,1) * B.LOAD_VAL) "LOAD_VAL" 
	FROM SYSTEM_LOAD_AREA A, 
	    AREA_LOAD B 
	WHERE B.AREA_ID = A.AREA_ID 
	GROUP BY A.SYSTEM_LOAD_ID, B.LOAD_DATE, B.LOAD_CODE;

