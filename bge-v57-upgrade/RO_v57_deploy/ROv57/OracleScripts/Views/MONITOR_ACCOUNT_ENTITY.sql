CREATE OR REPLACE VIEW MONITOR_ACCOUNT_ENTITY ( ENTITY_NAME, ENTITY_ALIAS, ENTITY_ID ) AS
SELECT DISTINCT 
	A.ACCOUNT_NAME "ENTITY_NAME", 
	A.ACCOUNT_ALIAS "ENTITY_ALIAS", 
	A.ACCOUNT_ID "ENTITY_ID" 
FROM ACCOUNT A, ACCOUNT_STATUS B, PROFILE_MONITOR C, ACCOUNT_STATUS_NAME D
WHERE B.ACCOUNT_ID = A.ACCOUNT_ID
	AND TRUNC(SYSDATE) BETWEEN B.BEGIN_DATE AND NVL(B.END_DATE, HIGH_DATE)
	AND D.STATUS_NAME = B.STATUS_NAME
	AND D.IS_ACTIVE = 1   
	AND C.ACCOUNT_ID = B.ACCOUNT_ID;
