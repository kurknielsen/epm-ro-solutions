CREATE OR REPLACE VIEW POOL_AND_POOL_SUB_POOL ( POOL_ID, 
SUB_POOL_ID, BEGIN_DATE, END_DATE, ALLOCATION_PCT
 ) AS SELECT POOL_ID, SUB_POOL_ID, BEGIN_DATE, END_DATE, ALLOCATION_PCT 
	FROM POOL_SUB_POOL
UNION ALL 
	SELECT POOL_ID, POOL_ID, LOW_DATE, HIGH_DATE, 100 
	FROM POOL 
	WHERE NOT UPPER(POOL_CATEGORY) IN ('AGGREGATE POOL', 'SUB POOL') 
UNION ALL 
	SELECT -3, -3, LOW_DATE, HIGH_DATE, 100 FROM DUAL;
