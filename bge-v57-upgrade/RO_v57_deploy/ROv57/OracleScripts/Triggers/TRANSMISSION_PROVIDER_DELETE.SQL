CREATE OR REPLACE TRIGGER TRANSMISSION_PROVIDER_DELETE
	AFTER DELETE ON TRANSMISSION_PROVIDER
	FOR EACH ROW
BEGIN
	DELETE TP_CONTRACT_NUMBER WHERE TP_ID = :old.TP_ID;
	UPDATE SERVICE_POINT SET TP_ID = 0 WHERE TP_ID = :old.TP_ID;
	DELETE TEMPORAL_ENTITY_ATTRIBUTE WHERE OWNER_ENTITY_ID = :old.TP_ID AND ATTRIBUTE_ID IN
		(SELECT A.ATTRIBUTE_ID FROM ENTITY_ATTRIBUTE A, ENTITY_DOMAIN B
		 WHERE UPPER(B.ENTITY_DOMAIN_TABLE_ALIAS) = 'TP' AND A.ENTITY_DOMAIN_ID = B.ENTITY_DOMAIN_ID);
	DELETE ENTITY_DOMAIN_CONTACT WHERE OWNER_ENTITY_ID = :old.TP_ID AND ENTITY_DOMAIN_ID IN
		(SELECT ENTITY_DOMAIN_ID FROM ENTITY_DOMAIN WHERE UPPER(ENTITY_DOMAIN_TABLE_ALIAS) = 'TP');
	DELETE ENTITY_DOMAIN_ADDRESS WHERE OWNER_ENTITY_ID = :old.TP_ID AND ENTITY_DOMAIN_ID IN
		(SELECT ENTITY_DOMAIN_ID FROM ENTITY_DOMAIN WHERE UPPER(ENTITY_DOMAIN_TABLE_ALIAS) = 'TP');
END TRANSMISSION_PROVIDER_DELETE;
/
