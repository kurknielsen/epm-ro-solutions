CREATE OR REPLACE TRIGGER PSE_DELETE
	AFTER DELETE ON PURCHASING_SELLING_ENTITY
	FOR EACH ROW
BEGIN
	DELETE PSE_ESP WHERE PSE_ID = :old.PSE_ID;
	DELETE PSE_PRE_SCHEDULE WHERE PSE_ID = :old.PSE_ID;
    DELETE PSE_CUSTOM_INVOICE WHERE PSE_ID = :old.PSE_ID;
	DELETE PROVIDER_SERVICE WHERE PSE_ID = :old.PSE_ID;
	DELETE TEMPORAL_ENTITY_ATTRIBUTE WHERE OWNER_ENTITY_ID = :old.PSE_ID AND ATTRIBUTE_ID IN
		(SELECT A.ATTRIBUTE_ID FROM ENTITY_ATTRIBUTE A, ENTITY_DOMAIN B
		 WHERE UPPER(B.ENTITY_DOMAIN_TABLE_ALIAS) = 'PSE' AND A.ENTITY_DOMAIN_ID = B.ENTITY_DOMAIN_ID);
	DELETE ENTITY_DOMAIN_ADDRESS WHERE OWNER_ENTITY_ID = :old.PSE_ID AND ENTITY_DOMAIN_ID IN
		(SELECT ENTITY_DOMAIN_ID FROM ENTITY_DOMAIN WHERE UPPER(ENTITY_DOMAIN_TABLE_ALIAS) = 'PSE');
	DELETE ENTITY_DOMAIN_CONTACT WHERE OWNER_ENTITY_ID = :old.PSE_ID AND ENTITY_DOMAIN_ID IN
		(SELECT ENTITY_DOMAIN_ID FROM ENTITY_DOMAIN WHERE UPPER(ENTITY_DOMAIN_TABLE_ALIAS) = 'PSE');
	UPDATE INTERCHANGE_CONTRACT SET BILLING_ENTITY_ID = 0 WHERE BILLING_ENTITY_ID = :old.PSE_ID;
	UPDATE INTERCHANGE_CONTRACT SET PURCHASER_ID = 0 WHERE PURCHASER_ID = :old.PSE_ID;
	UPDATE INTERCHANGE_CONTRACT SET SELLER_ID = 0 WHERE SELLER_ID = :old.PSE_ID;
	UPDATE INTERCHANGE_TRANSACTION SET PURCHASER_ID = 0 WHERE PURCHASER_ID = :old.PSE_ID;
	UPDATE INTERCHANGE_TRANSACTION SET SELLER_ID = 0 WHERE SELLER_ID = :old.PSE_ID;
	UPDATE INTERCHANGE_TRANSACTION SET PSE_ID = 0 WHERE PSE_ID = :old.PSE_ID;
END PSE_DELETE;
/
