CREATE OR REPLACE TRIGGER ESP_DELETE
	AFTER DELETE ON ENERGY_SERVICE_PROVIDER
	FOR EACH ROW
BEGIN
	DELETE PSE_ESP WHERE ESP_ID = :old.ESP_ID;
	DELETE ESP_POOL WHERE ESP_ID = :old.ESP_ID;
	DELETE ACCOUNT_ESP WHERE ESP_ID = :old.ESP_ID;
	DELETE AGGREGATE_ACCOUNT_ESP WHERE ESP_ID = :old.ESP_ID;
	DELETE SHADOW_SETTLEMENT WHERE ESP_ID = :old.ESP_ID;
	DELETE PROVIDER_SERVICE WHERE EDC_ID = :old.ESP_ID;
	UPDATE INTERCHANGE_TRANSACTION SET ESP_ID = 0 WHERE ESP_ID = :old.ESP_ID;
END ESP_DELETE;
/
