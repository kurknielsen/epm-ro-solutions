CREATE OR REPLACE TRIGGER STATION_PARAMETER_VALUE_INSERT
	BEFORE INSERT ON STATION_PARAMETER_VALUE
	FOR EACH ROW
DECLARE
	v_INTERVAL_ABBR VARCHAR(2);
BEGIN

	SELECT DECODE(PARAMETER_INTERVAL,'Hour', 'HH', 'Day', 'DD', 'MI')
	INTO v_INTERVAL_ABBR
	FROM WEATHER_PARAMETER
	WHERE PARAMETER_ID = :new.PARAMETER_ID;

	:new.PARAMETER_DATE := TRUNC(:new.PARAMETER_DATE,v_INTERVAL_ABBR);

END STATION_PARAMETER_VALUE_INSERT;
/ 
