create or replace trigger ACCOUNT_USAGE_FACTOR_UPDATE
  BEFORE INSERT OR UPDATE ON ACCOUNT_USAGE_FACTOR
  FOR EACH ROW
DECLARE

BEGIN

    IF (:OLD.CASE_ID IS NULL OR :OLD.ACCOUNT_ID IS NULL OR :OLD.BEGIN_DATE IS NULL) -- INSERT
      OR (:OLD.CASE_ID <> :NEW.CASE_ID
            OR :OLD.ACCOUNT_ID <> :NEW.ACCOUNT_ID
            OR :OLD.BEGIN_DATE <> :NEW.BEGIN_DATE
            OR NVL(:OLD.END_DATE,HIGH_DATE) <> NVL(:NEW.END_DATE, HIGH_DATE)
            OR NVL(:OLD.FACTOR_VAL,-1) <> NVL(:NEW.FACTOR_VAL,-1)) THEN
        -- INSERT OR AN UPDATE WHICH TOUCHES COLUMNS OTHER THAN SOURCE INFO
        :NEW.SOURCE_CALENDAR_ID := NULL;
        :NEW.SOURCE_BEGIN_DATE := NULL;
        :NEW.SOURCE_END_DATE := NULL;
    END IF;
  
END ACCOUNT_USAGE_FACTOR_UPDATE;
/
