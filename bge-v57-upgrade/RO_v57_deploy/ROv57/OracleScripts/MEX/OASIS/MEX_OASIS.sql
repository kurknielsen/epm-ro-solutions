CREATE OR REPLACE PACKAGE MEX_OASIS IS
-- $Revision: 1.38 $

	-- Author  : VGODYN
	-- Created : 7/13/2005 11:06:39 AM
	-- Purpose : tranlate between csv and types using the OASIS templates

	g_SUCCESS  CONSTANT NUMBER(1) := 0;
	g_FAIL     CONSTANT NUMBER(1) := -1;
	g_UPLOAD   CONSTANT VARCHAR2(8) := 'UPLOAD';
	g_DOWNLOAD CONSTANT VARCHAR2(8) := 'DOWNLOAD';
	g_ISO_DEBUG BOOLEAN := TRUE;


	g_DEFAULT_PROFILE MEX_OASIS_TRANS_PROFILE := MEX_OASIS_TRANS_PROFILE(
			START_TIME            => NULL,
			STOP_TIME             => NULL,
			ASSIGNMENT_REF        => NULL,
			REASSIGNED_REF        => NULL,
			PATH_NAME             => NULL,
			POINT_OF_RECEIPT      => NULL,
			POINT_OF_DELIVERY     => NULL,
			OFFER_PRICE           => NULL,
			BID_PRICE             => NULL,
			CAPACITY_REQUESTED    => NULL,
			CAPACITY_GRANTED      => NULL,
			REASSIGNED_CAPACITY   => NULL,
			REASSIGNED_START_TIME => NULL,
			REASSIGNED_STOP_TIME  => NULL,
			CUSTOMER_COMMENTS     => NULL,
			CAPACITY              => NULL);

	g_DEFAULT_DATA MEX_OASIS_TRANS_DATA := MEX_OASIS_TRANS_DATA(
		RECORD_STATUS               => NULL,
		SELLER_CODE                 => NULL,
		SELLER_DUNS                 => NULL,
		CUSTOMER_CODE               => NULL,
		CUSTOMER_DUNS               => NULL,
		AFFILIATE_FLAG              => NULL,
		SOURCE                      => NULL,
		SINK                        => NULL,
		SERVICE_INCREMENT           => NULL,
		TS_CLASS                    => NULL,
		TS_TYPE                     => NULL,
		TS_PERIOD                   => NULL,
		TS_WINDOW                   => NULL,
		TS_SUBCLASS                 => NULL,
		STATUS_NOTIFICATION         => NULL,
		NERC_CURTAILEMENT_PRIORITY  => NULL,
		OTHER_CURTAILEMENT_PRIORITY => NULL,
		START_TIME_QUEUED           => NULL,
		STOP_TIME_QUEUED            => NULL,
		NEGOTIATED_PRICE_FLAG       => NULL,
		CEILING_PRICE               => NULL,
		PRICE_UNITS                 => NULL,
		PRECONFIRMED                => NULL,
		ANC_SVC_LINK                => NULL,
		ANC_SVC_REQ                 => NULL,
		POSTING_REF                 => NULL,
		SALE_REF                    => NULL,
		REQUEST_REF                 => NULL,
		DEAL_REF                    => NULL,
		REQUEST_TYPE                => NULL,
		RELATED_REF                 => NULL,
		ERROR_MESSAGE               => NULL,
		IMPACTED                    => NULL,
		COMPETING_REQUEST_FLAG      => NULL,
		TIME_OF_LAST_UPDATE         => NULL,
		STATUS                      => NULL,
		STATUS_COMMENTS             => NULL,
		TIME_QUEUED                 => NULL,
		RESPONSE_TIME_LIMIT         => NULL,
		PRIMARY_PROVIDER_COMMENTS   => NULL,
		SELLER_REF                  => NULL,
		SELLER_COMMENTS             => NULL,
		SELLER_NAME                 => NULL,
		SELLER_PHONE                => NULL,
		SELLER_FAX                  => NULL,
		SELLER_EMAIL                => NULL,
		CUSTOMER_NAME               => NULL,
		CUSTOMER_PHONE              => NULL,
		CUSTOMER_FAX                => NULL,
		CUSTOMER_EMAIL              => NULL,
		POSTING_NAME                => NULL,
		INTERFACE_TYPE              => NULL,
		OFFER_START_TIME            => NULL,
		OFFER_STOP_TIME             => NULL,
		SERVICE_DESCRIPTION         => NULL,
		CONTROL_AREA                => NULL,
		AS_TYPE                     => NULL,
		ANC_SERVICE_POINT           => NULL,
		PROFILE_TABLE               => MEX_OASIS_TRANS_profile_tbl(g_default_profile));

	/*g_DEFAULT_LIST_DATA MEX_OASIS_LIST_DATA := MEX_OASIS_LIST_DATA(TIME_OF_LAST_UPDATE   => NULL,
																   LIST_NAME             => NULL,
																   LIST_ITEM             => NULL,
																   LIST_ITEM_DESCRIPTION => NULL);
*/
	TYPE PARAMETER_MAP IS TABLE OF VARCHAR2(512) INDEX BY VARCHAR2(512);
	-----------------------------------------

FUNCTION WHAT_VERSION RETURN VARCHAR2;
--------------------------------------------------------
	PROCEDURE PARSE_TRANSCUST_RESPONSE
		(
		p_CSV     IN CLOB,
		p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
		p_TAB     OUT MEX_OASIS_TRANS
		);
--------------------------------------------------------

-- LIST--
PROCEDURE FETCH_OASIS_LIST
(
    p_EXT_CREDS     IN MEX_CREDENTIALS,
    p_PROVIDER_CODE IN VARCHAR2,
    p_PROVIDER_DUNS IN NUMBER,
    p_URL           IN VARCHAR2,
    p_RECORDS       IN OUT MEX_OASIS_LIST_RES_TBL,
    p_LOGGER        IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS        OUT NUMBER
);

-- Transmission Services

PROCEDURE SUBMIT_TRANSOFFERING
	(
	p_TAB      IN OUT MEX_OASIS_TRANS,
	p_ExtCreds IN MEX_CREDENTIALS,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER
	);

PROCEDURE SUBMIT_TRANSREQUEST
	(
	p_TAB IN OUT MEX_OASIS_TRANS,
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_URL IN VARCHAR2,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS      OUT NUMBER
	);

PROCEDURE FETCH_TRANSSTATUS
	(
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_PROVIDER_CODE IN VARCHAR2,
	p_OASIS_URL     IN VARCHAR2,
	p_BEGIN_DATE    IN DATE,
	p_END_DATE      IN DATE,
	p_RECORDS       IN OUT MEX_OASIS_TRANS,
	p_LOGGER        IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_OASIS_STATUS_LIST IN VARCHAR2 DEFAULT NULL,
	p_CUSTOMER_LIST IN VARCHAR2 DEFAULT NULL,
	p_ASSIGNMENT_REF IN VARCHAR2 DEFAULT NULL,
	p_STATUS        OUT NUMBER
	);

PROCEDURE SUBMIT_TRANSSELL
	(
	p_TAB IN OUT MEX_OASIS_TRANS,
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_URL IN VARCHAR2,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS      OUT NUMBER
	);

PROCEDURE SUBMIT_TRANSCUST
	(
	p_TAB IN OUT MEX_OASIS_TRANS,
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_URL IN VARCHAR2,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS      OUT NUMBER
	);

PROCEDURE SUBMIT_TRANSASSIGN
	(
	p_TAB IN OUT MEX_OASIS_TRANS,
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_URL IN VARCHAR2,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS      OUT NUMBER
	);

PROCEDURE SUBMIT_TRANSPOST
	(
	p_TAB IN OUT MEX_OASIS_TRANS,
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_URL IN VARCHAR2,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS      OUT NUMBER
	);

PROCEDURE SUBMIT_TRANSUPDATE
	(
	p_TAB IN OUT MEX_OASIS_TRANS,
	p_CREDENTIALS IN MEX_CREDENTIALS,
	p_URL IN VARCHAR2,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_STATUS      OUT NUMBER
	);

PROCEDURE PARSE_TRANSSTATUS_RESPONSE
	(
	p_CSV IN CLOB,
	p_LOGGER IN OUT NOCOPY MM_LOGGER_ADAPTER,
	p_TAB OUT MEX_OASIS_TRANS
	);

	-- Ancillary Services
/*
	PROCEDURE SUBMIT_ANCOFFERING(p_TAB      IN OUT MEX_OASIS_TRANS,
								 p_ExtCreds IN MEX_CREDENTIALS,
								 p_STATUS   OUT NUMBER,
								 P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCREQUEST(p_TAB      IN OUT MEX_OASIS_TRANS,
								p_ExtCreds IN MEX_CREDENTIALS,
								p_STATUS   OUT NUMBER,
								P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCSTATUS(p_TAB      IN OUT MEX_OASIS_TRANS,
							   p_ExtCreds IN MEX_CREDENTIALS,
							   p_STATUS   OUT NUMBER,
							   P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCSELL(p_TAB      IN OUT MEX_OASIS_TRANS,
							 p_ExtCreds IN MEX_CREDENTIALS,
							 p_STATUS   OUT NUMBER,
							 P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCCUST(p_TAB      IN OUT MEX_OASIS_TRANS,
							 p_ExtCreds IN MEX_CREDENTIALS,
							 p_STATUS   OUT NUMBER,
							 P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCASSIGN(p_TAB      IN OUT MEX_OASIS_TRANS,
							   p_ExtCreds IN MEX_CREDENTIALS,
							   p_STATUS   OUT NUMBER,
							   P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCPOST(p_TAB      IN OUT MEX_OASIS_TRANS,
							 p_ExtCreds IN MEX_CREDENTIALS,
							 p_STATUS   OUT NUMBER,
							 P_MESSAGE  OUT VARCHAR2);

	PROCEDURE SUBMIT_ANCUPDATE(p_TAB      IN OUT MEX_OASIS_TRANS,
							   p_ExtCreds IN MEX_CREDENTIALS,
							   p_STATUS   OUT NUMBER,
							   P_MESSAGE  OUT VARCHAR2);
*/
	-- communications

FUNCTION IS_CONNECTION_LIVE RETURN BOOLEAN;

PROCEDURE RUN_OASIS_EXCHANGE
(
    p_FETCH_URL          IN VARCHAR2,
    p_REQUEST_TYPE       IN VARCHAR2,
    p_CRED               IN MEX_CREDENTIALS,
    p_REQUEST_DIRECTION  IN VARCHAR2,
    p_CLOB_REQUEST       IN CLOB,
	p_LOGGER             IN OUT NOCOPY MM_LOGGER_ADAPTER,
    p_CLOB_RESPONSE      OUT CLOB
);

END MEX_OASIS;
/