CREATE OR REPLACE FUNCTION OFF_PEAK_HOLIDAY
	(
	p_DATE DATE
	)
	RETURN VARCHAR IS
--Revision: $Revision: 1.17 $
--c	Set the type either on peak or off peak time
BEGIN
	IF TO_NUMBER(TO_CHAR(p_DATE, 'D')) = 2 AND TO_NUMBER(TO_CHAR(p_DATE, 'MM')) = 5 AND TO_NUMBER(TO_CHAR(p_DATE, 'DD')) > 23 THEN
	   RETURN 'TRUE';
	ELSIF TO_NUMBER(TO_CHAR(p_DATE, 'D')) = 2 AND TO_NUMBER(TO_CHAR(p_DATE, 'MM')) = 9 AND TO_NUMBER(TO_CHAR(p_DATE, 'DD')) < 8 THEN
	   RETURN 'TRUE';
	ELSIF TO_NUMBER(TO_CHAR(p_DATE, 'D')) = 5 AND TO_NUMBER(TO_CHAR(p_DATE, 'MM')) = 11 AND TO_NUMBER(TO_CHAR(p_DATE, 'DD')) > 22 THEN
	   RETURN 'TRUE';
	ELSE
	   RETURN 'FALSE';
	END IF;
END OFF_PEAK_HOLIDAY;
/

