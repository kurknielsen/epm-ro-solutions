DECLARE

PROCEDURE PUT_STATEMENT_TYPE(p_NEW_STATEMENT_NAME IN STATEMENT_TYPE.STATEMENT_TYPE_NAME%TYPE,
							 p_STATEMENT_TYPE_ORDER STATEMENT_TYPE.STATEMENT_TYPE_ORDER%TYPE) IS
	
    v_STATEMENT_TYPE_ID         STATEMENT_TYPE.STATEMENT_TYPE_ID%TYPE := 0;
    v_STATEMENT_TYPE_ALIAS      STATEMENT_TYPE.STATEMENT_TYPE_ALIAS%TYPE := p_NEW_STATEMENT_NAME;
    v_STATEMENT_TYPE_DESC       STATEMENT_TYPE.STATEMENT_TYPE_DESC%TYPE := p_NEW_STATEMENT_NAME;
	BEGIN	
        BEGIN
        
            SELECT STATEMENT_TYPE_ID INTO v_STATEMENT_TYPE_ID FROM STATEMENT_TYPE
            WHERE UPPER(STATEMENT_TYPE_ALIAS) = UPPER(TRIM(v_STATEMENT_TYPE_DESC))
            OR UPPER(STATEMENT_TYPE_ALIAS) = UPPER(TRIM(p_NEW_STATEMENT_NAME));
            
            -- statement type exists; update            
            UPDATE STATEMENT_TYPE 
            SET STATEMENT_TYPE_NAME=p_NEW_STATEMENT_NAME, STATEMENT_TYPE_ALIAS=v_STATEMENT_TYPE_ALIAS,
            STATEMENT_TYPE_DESC=v_STATEMENT_TYPE_DESC, STATEMENT_TYPE_ORDER = p_STATEMENT_TYPE_ORDER
            WHERE STATEMENT_TYPE_ID=v_STATEMENT_TYPE_ID;
            
        EXCEPTION
        
			WHEN OTHERS THEN
            -- new statement type; create
            v_STATEMENT_TYPE_ID := 0;
            IO.PUT_STATEMENT_TYPE(v_STATEMENT_TYPE_ID,
                  p_NEW_STATEMENT_NAME,
                  p_NEW_STATEMENT_NAME,
                  p_NEW_STATEMENT_NAME,
                  0,
                  p_STATEMENT_TYPE_ORDER);
                  
		END;
	
		-- Add external identifier
		EI.PUT_EXTERNAL_SYSTEM_IDENTIFIER(EC.ES_SEM,
										  EC.ED_STATEMENT_TYPE,
										  v_STATEMENT_TYPE_ID,
										  CASE p_NEW_STATEMENT_NAME WHEN 'SMO Initial' THEN 'SMO F' ELSE 'SMO P' END,
										  MM_SEM_UTIL.g_STATEMENT_TYPE_SETTLEMENT);
	
		--add an additional external identifier, 'Market Schedules' 
		--in order to make visible the associated schedules in Schedule Tree tab
		EI.PUT_EXTERNAL_SYSTEM_IDENTIFIER(EC.ES_SEM,
										  EC.ED_STATEMENT_TYPE,
										  v_STATEMENT_TYPE_ID,
										  p_NEW_STATEMENT_NAME,
										  MM_SEM_UTIL.g_STATEMENT_TYPE_MKT_SCHED);
END PUT_STATEMENT_TYPE;
BEGIN
	PUT_STATEMENT_TYPE('SMO Indicative', 100);
	PUT_STATEMENT_TYPE('SMO Initial', 101);
    
    COMMIT;
END;
/
