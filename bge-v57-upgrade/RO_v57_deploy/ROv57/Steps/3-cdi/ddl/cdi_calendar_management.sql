BEGIN CDI_DROP_OBJECT('CDI_CALENDAR_MANAGEMENT', 'TABLE'); END;
/

CREATE TABLE CDI_CALENDAR_MANAGEMENT
(
  CALENDAR_MANAGEMENT_ID   INTEGER,
  CALENDAR_MANAGEMENT_TYPE VARCHAR2(16),
  CALENDAR_ID              INTEGER,
  PROFILE_LIBRARY_ID       INTEGER,
  PROFILE_ID               INTEGER,
  ADJUSTMENT_OPERATION     VARCHAR2(16),
  ADJUSTMENT_VALUE         NUMBER,
  INCLUDE_ENTRY            NUMBER(1),
  MONTH_JAN                NUMBER(1),
  MONTH_FEB                NUMBER(1),
  MONTH_MAR                NUMBER(1),
  MONTH_APR                NUMBER(1),
  MONTH_MAY                NUMBER(1),
  MONTH_JUN                NUMBER(1),
  MONTH_JUL                NUMBER(1),
  MONTH_AUG                NUMBER(1),
  MONTH_SEP                NUMBER(1),
  MONTH_OCT                NUMBER(1),
  MONTH_NOV                NUMBER(1),
  MONTH_DEC                NUMBER(1),
  DAY_MON                  NUMBER(1),
  DAY_TUE                  NUMBER(1),
  DAY_WED                  NUMBER(1),
  DAY_THU                  NUMBER(1),
  DAY_FRI                  NUMBER(1),
  DAY_SAT                  NUMBER(1),
  DAY_SUN                  NUMBER(1),
  ENTRY_DATE               DATE,
  PROFILE_NAME             VARCHAR2(128),
  PROFILE_LIBRARY_NAME     VARCHAR2(128),
  CALENDAR_NAME            VARCHAR2(128),
  IS_MONTH_FILTER          NUMBER(1),
  IS_DAY_FILTER            NUMBER(1),
  CONSTRAINT PK_CDI_CALENDAR_MANAGEMENT PRIMARY KEY (CALENDAR_MANAGEMENT_ID) USING INDEX TABLESPACE &&NERO_INDEX_TABLESPACE
) TABLESPACE &&NERO_DATA_TABLESPACE;

BEGIN CDI_DROP_OBJECT('CDI_CALENDAR_MANAGEMENT_ID', 'SEQUENCE'); END;
/

CREATE SEQUENCE CDI_CALENDAR_MANAGEMENT_ID
  START WITH 1
  MAXVALUE 999999999
  MINVALUE 1
  CYCLE
  CACHE 20
  NOORDER;

CREATE OR REPLACE TRIGGER CALENDAR_MANAGEMENT_UPDATE
   BEFORE INSERT OR UPDATE ON CDI_CALENDAR_MANAGEMENT FOR EACH ROW
BEGIN
   :new.INCLUDE_ENTRY := NVL(:new.INCLUDE_ENTRY,'0');
   :new.MONTH_JAN := NVL(:new.MONTH_JAN,0);
   :new.MONTH_FEB := NVL(:new.MONTH_FEB,0);
   :new.MONTH_MAR := NVL(:new.MONTH_MAR,0);
   :new.MONTH_APR := NVL(:new.MONTH_APR,0);
   :new.MONTH_MAY := NVL(:new.MONTH_MAY,0);
   :new.MONTH_JUN := NVL(:new.MONTH_JUN,0);
   :new.MONTH_JUL := NVL(:new.MONTH_JUL,0);
   :new.MONTH_AUG := NVL(:new.MONTH_AUG,0);
   :new.MONTH_SEP := NVL(:new.MONTH_SEP,0);
   :new.MONTH_OCT := NVL(:new.MONTH_OCT,0);
   :new.MONTH_NOV := NVL(:new.MONTH_NOV,0);
   :new.MONTH_DEC := NVL(:new.MONTH_DEC,0);
   :new.DAY_MON := NVL(:new.DAY_MON,0);
   :new.DAY_TUE := NVL(:new.DAY_TUE,0);
   :new.DAY_WED := NVL(:new.DAY_WED,0);
   :new.DAY_THU := NVL(:new.DAY_THU,0);
   :new.DAY_FRI := NVL(:new.DAY_FRI,0);
   :new.DAY_SAT := NVL(:new.DAY_SAT,0);
   :new.DAY_SUN := NVL(:new.DAY_SUN,0);
   :new.IS_MONTH_FILTER := CASE WHEN :new.MONTH_JAN + :new.MONTH_FEB + :new.MONTH_MAR + :new.MONTH_APR + :new.MONTH_MAY + :new.MONTH_JUN + :new.MONTH_JUL + :new.MONTH_AUG + :new.MONTH_SEP + :new.MONTH_OCT + :new.MONTH_NOV + :new.MONTH_DEC > 0 THEN 1 ELSE 0 END;
   :new.IS_DAY_FILTER := CASE WHEN :new.DAY_MON + :new.DAY_TUE + :new.DAY_WED + :new.DAY_THU + :new.DAY_FRI + :new.DAY_SAT + :new.DAY_SUN > 0 THEN 1 ELSE 0 END;
END CALENDAR_MANAGEMENT_UPDATE;
/
