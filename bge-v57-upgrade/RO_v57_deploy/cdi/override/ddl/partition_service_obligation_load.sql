BEGIN CDI_DROP_OBJECT('SERVICE_OBLIGATION_LOAD','TABLE'); END;
/

CREATE TABLE SERVICE_OBLIGATION_LOAD
(
  SERVICE_OBLIGATION_ID  NUMBER(9)              NOT NULL,
  SERVICE_CODE           CHAR(1 CHAR)           NOT NULL,
  LOAD_DATE              DATE                   NOT NULL,
  LOAD_CODE              CHAR(1 BYTE)           NOT NULL,
  LOAD_VAL               NUMBER(14,4),
  TX_LOSS_VAL            NUMBER(10,4),
  DX_LOSS_VAL            NUMBER(10,4),
  AGG_LOAD_VAL           NUMBER(14,4),
  AGG_TX_LOSS_VAL        NUMBER(10,4),
  AGG_DX_LOSS_VAL        NUMBER(10,4),
  UFE_LOAD_VAL           NUMBER(14,4)
) TABLESPACE "SERVICE_LOAD"
PARTITION BY RANGE (LOAD_DATE)
SUBPARTITION BY LIST (SERVICE_CODE)
SUBPARTITION TEMPLATE (SUBPARTITION B VALUES ('B') TABLESPACE "SERVICE_LOAD", SUBPARTITION A VALUES ('A') TABLESPACE "SERVICE_LOAD")
(  
PARTITION PRIOR_PERIOD VALUES LESS THAN (TO_DATE(' 2019-01-01 00:00:00', 'SYYYY-MM-DD HH24:MI:SS')) TABLESPACE "SERVICE_LOAD" (SUBPARTITION PRIOR_PERIOD_B VALUES('B') TABLESPACE "SERVICE_LOAD", SUBPARTITION PRIOR_PERIOD_A VALUES ('A') TABLESPACE "SERVICE_LOAD")
);

CREATE UNIQUE INDEX PK_SERVICE_OBLIGATION_LOAD ON SERVICE_OBLIGATION_LOAD(SERVICE_OBLIGATION_ID, SERVICE_CODE, LOAD_DATE, LOAD_CODE) TABLESPACE NERO_LARGE_INDEX LOCAL
(  
PARTITION PRIOR_PERIOD TABLESPACE NERO_LARGE_INDEX (SUBPARTITION PRIOR_PERIOD_B TABLESPACE NERO_LARGE_INDEX, SUBPARTITION PRIOR_PERIOD_A TABLESPACE NERO_LARGE_INDEX)
);

ALTER TABLE SERVICE_OBLIGATION_LOAD ADD (CONSTRAINT PK_SERVICE_OBLIGATION_LOAD PRIMARY KEY (SERVICE_OBLIGATION_ID, SERVICE_CODE, LOAD_DATE, LOAD_CODE) USING INDEX LOCAL ENABLE VALIDATE);
