CREATE OR REPLACE VIEW TYPICAL_DAY_PROFILE_EXPORT$ AS
WITH TYPICAL_DAY_PROFILE AS
   (SELECT 'Typical Day' AS PROFILE_TYPE, LPL.PROFILE_LIBRARY_ID, LPL.PROFILE_LIBRARY_NAME, LP.PROFILE_NAME, CASE TO_CHAR(POINT_DATE,'HH24') WHEN '00' THEN 'HR24' ELSE 'HR' || TO_CHAR(POINT_DATE,'HH24') END POINT_HOUR, ROUND(LPP.POINT_VAL,3) POINT_VAL
   FROM LOAD_PROFILE_LIBRARY LPL
      JOIN LOAD_PROFILE LP ON LP.PROFILE_LIBRARY_ID = LPL.PROFILE_LIBRARY_ID
      JOIN LOAD_PROFILE_POINT LPP ON LPP.PROFILE_ID = LP.PROFILE_ID AND LPP.POINT_INDEX = 1 AND LPP.AS_OF_DATE = LOW_DATE)
SELECT *
FROM TYPICAL_DAY_PROFILE
PIVOT (MAX(POINT_VAL) FOR POINT_HOUR IN('HR01' "HR01",'HR02' "HR02",'HR03' "HR03",'HR04' "HR04",'HR05' "HR05",'HR06' "HR06",'HR07' "HR07",'HR08' "HR08",'HR09' "HR09",'HR10' "HR10",'HR11' "HR11",'HR12' "HR12",'HR13' "HR13",'HR14' "HR14",'HR15' "HR15",'HR16' "HR16",'HR17' "HR17",'HR18' "HR18",'HR19' "HR19",'HR20' "HR20",'HR21' "HR21",'HR22' "HR22",'HR23' "HR23",'HR24' "HR24"));        
