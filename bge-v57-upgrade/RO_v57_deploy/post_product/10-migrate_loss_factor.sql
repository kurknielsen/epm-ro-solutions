ALTER TABLE LOSS_FACTOR_MODEL DISABLE CONSTRAINT FK_LOSS_FACTOR_MODEL;
ALTER TABLE LOSS_FACTOR_PATTERN DISABLE CONSTRAINT FK_LOSS_FACTOR_PATTERN;
DECLARE
v_ID NUMBER(9);
BEGIN
   INSERT INTO LOSS_FACTOR(LOSS_FACTOR_ID, LOSS_FACTOR_NAME, LOSS_FACTOR_ALIAS, LOSS_FACTOR_DESC, EXTERNAL_IDENTIFIER, ENTRY_DATE)
   SELECT LOSS_FACTOR_ID, LOSS_FACTOR_NAME, LOSS_FACTOR_ALIAS, LOSS_FACTOR_DESC, EXTERNAL_IDENTIFIER, ENTRY_DATE FROM X_LOSS_FACTOR;
   INSERT INTO LOSS_FACTOR_MODEL(LOSS_FACTOR_ID, BEGIN_DATE, END_DATE, PATTERN_ID, LOSS_TYPE, FACTOR_TYPE, MODEL_TYPE, INTERVAL, ENTRY_DATE)
   SELECT LOSS_FACTOR_ID, BEGIN_DATE, END_DATE, PATTERN_ID, 'Distribution', 'Expansion', 'Pattern', 'Day', SYSDATE FROM X_LOSS_FACTOR_MODEL;
   INSERT INTO LOSS_FACTOR_PATTERN(PATTERN_ID, PATTERN_DATE, LOSS_VAL)
   SELECT PATTERN_ID, LOW_DATE, PATTERN_VAL FROM X_LOSS_FACTOR_PATTERN;
   v_ID := 101;
   FOR v_SELECT IN (SELECT LOSS_FACTOR_ID FROM LOSS_FACTOR WHERE LOSS_FACTOR_ID > 0 ORDER BY LOSS_FACTOR_ID) LOOP
      UPDATE LOSS_FACTOR SET LOSS_FACTOR_ID = v_ID WHERE LOSS_FACTOR_ID = v_SELECT.LOSS_FACTOR_ID;
      UPDATE LOSS_FACTOR_MODEL SET LOSS_FACTOR_ID = v_ID WHERE LOSS_FACTOR_ID = v_SELECT.LOSS_FACTOR_ID;
      v_ID := v_ID + 1;
   END LOOP;
   v_ID := 101;
   FOR v_SELECT IN (SELECT PATTERN_ID FROM LOSS_FACTOR_MODEL WHERE LOSS_FACTOR_ID > 0 ORDER BY PATTERN_ID) LOOP
      UPDATE LOSS_FACTOR_PATTERN SET PATTERN_ID = v_ID WHERE PATTERN_ID = v_SELECT.PATTERN_ID;
      UPDATE LOSS_FACTOR_MODEL   SET PATTERN_ID = v_ID WHERE PATTERN_ID = v_SELECT.PATTERN_ID;
      v_ID := v_ID + 1;
   END LOOP;
   COMMIT;
END;
/
ALTER TABLE LOSS_FACTOR_MODEL ENABLE CONSTRAINT FK_LOSS_FACTOR_MODEL;
ALTER TABLE LOSS_FACTOR_PATTERN ENABLE CONSTRAINT FK_LOSS_FACTOR_PATTERN;
