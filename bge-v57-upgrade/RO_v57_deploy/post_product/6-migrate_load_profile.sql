-- Re-Populate The Content In The Target Table --
INSERT INTO CALENDAR                SELECT * FROM X_CALENDAR;
INSERT INTO CALENDAR_PROFILE        SELECT * FROM X_CALENDAR_PROFILE;
INSERT INTO LOAD_PROFILE            SELECT * FROM X_LOAD_PROFILE;
INSERT INTO LOAD_PROFILE_LIBRARY    SELECT * FROM X_LOAD_PROFILE_LIBRARY;
INSERT INTO LOAD_PROFILE_POINT      SELECT * FROM X_LOAD_PROFILE_POINT;
INSERT INTO LOAD_PROFILE_STATISTICS SELECT * FROM X_LOAD_PROFILE_STATISTICS;
COMMIT;
DECLARE
v_ID NUMBER(9);
BEGIN
   v_ID := 101;
   FOR v_SELECT IN (SELECT CALENDAR_ID FROM CALENDAR WHERE CALENDAR_ID > 0 ORDER BY CALENDAR_NAME) LOOP
      UPDATE CALENDAR_PROFILE SET CALENDAR_ID = v_ID WHERE CALENDAR_ID = v_SELECT.CALENDAR_ID;
      UPDATE CALENDAR SET CALENDAR_ID = v_ID WHERE CALENDAR_ID = v_SELECT.CALENDAR_ID;
      v_ID := v_ID + 1;
   END LOOP;
   v_ID := 101;
   FOR v_SELECT IN (SELECT PROFILE_ID FROM LOAD_PROFILE WHERE PROFILE_ID > 0 ORDER BY PROFILE_NAME) LOOP
      UPDATE CALENDAR_PROFILE SET PROFILE_ID = v_ID WHERE PROFILE_ID = v_SELECT.PROFILE_ID;
      UPDATE LOAD_PROFILE_POINT SET PROFILE_ID = v_ID WHERE PROFILE_ID = v_SELECT.PROFILE_ID;
      UPDATE LOAD_PROFILE_STATISTICS SET PROFILE_ID = v_ID WHERE PROFILE_ID = v_SELECT.PROFILE_ID;
      UPDATE LOAD_PROFILE SET PROFILE_ID = v_ID WHERE PROFILE_ID = v_SELECT.PROFILE_ID;
      v_ID := v_ID + 1;
   END LOOP;
   UPDATE LOAD_PROFILE SET PROFILE_ACCOUNT_REF = NULL, PROFILE_SOURCE_ID = NULL;
   v_ID := 101;
   FOR v_SELECT IN (SELECT PROFILE_LIBRARY_ID FROM LOAD_PROFILE_LIBRARY WHERE PROFILE_LIBRARY_ID > 0 ORDER BY PROFILE_LIBRARY_NAME) LOOP
      UPDATE LOAD_PROFILE SET PROFILE_LIBRARY_ID = v_ID WHERE PROFILE_LIBRARY_ID = v_SELECT.PROFILE_LIBRARY_ID;
      UPDATE LOAD_PROFILE_LIBRARY SET PROFILE_LIBRARY_ID = v_ID WHERE PROFILE_LIBRARY_ID = v_SELECT.PROFILE_LIBRARY_ID;
      v_ID := v_ID + 1;
   END LOOP;
END;
/

SELECT 'LOAD_PROFILE_POINT Record Count: ' || TO_CHAR(COUNT(*)) AS RECORD_COUNT FROM LOAD_PROFILE_POINT;
