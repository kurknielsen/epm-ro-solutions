CREATE OR REPLACE PACKAGE CS AS
--Revision $Revision: 1.105 $

-- Common Shared Package.

FUNCTION WHAT_VERSION RETURN VARCHAR;

PROCEDURE JOBS_IN_QUEUE
	(
	p_REQUEST_TYPE IN VARCHAR,
	p_STATUS OUT NUMBER,
	p_CURSOR IN OUT GA.REFCURSOR
	);

PROCEDURE REMOVE_JOB
	(
	p_JOB IN BINARY_INTEGER,
	p_STATUS OUT NUMBER
	);

PROCEDURE PUT_AREA_LOAD
	(
	p_AREA_LOAD IN AREA_LOAD%ROWTYPE,
	p_STATUS OUT NUMBER
	);

FUNCTION GET_PROVIDER_SERVICE
	(
	p_PROVIDER_SERVICE_ID IN NUMBER
	) RETURN PROVIDER_SERVICE%ROWTYPE;

FUNCTION GET_ACCOUNT_SERVICE
	(
	p_ACCOUNT_SERVICE_ID IN NUMBER
	) RETURN ACCOUNT_SERVICE%ROWTYPE;

FUNCTION GET_ESP_ID
	(
	p_ESP_NAME IN VARCHAR,
	p_IDENT_TYPE IN CHAR DEFAULT 'N'
	) RETURN NUMBER;

FUNCTION GET_ESP_OF_RECORD
	(
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_ESP_OF_RECORD
	(
	p_ACCOUNT_ID IN NUMBER,
	p_AGGREGATE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_EDC_OF_RECORD
	(
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_PSE_OF_RECORD
	(
	p_ESP_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_POOL_OF_RECORD
	(
	p_ACCOUNT_ID IN NUMBER,
	p_ESP_ID IN NUMBER,
	p_SERVICE_DATE IN DATE,
	p_IS_AGGREGATE_ACCOUNT IN BOOLEAN DEFAULT FALSE
	) RETURN NUMBER;

FUNCTION GET_AGGREGATE_POOL_OF_RECORD
	(
	p_AGGREGATE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_ACCOUNT_PSE_OF_RECORD
	(
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_EDC_SC_OF_RECORD
	(
	p_EDC_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_SCHEDULE_GROUP_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_METER_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_SC_ID
	(
	p_EDC_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_ACCOUNT_ID
	(
	p_ACCOUNT_IDENT IN VARCHAR,
	p_IDENT_TYPE IN CHAR DEFAULT 'N'
	) RETURN NUMBER;

FUNCTION GET_SERVICE_LOCATION_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_METER_NAME
	(
	p_METER_ID IN NUMBER
	) RETURN VARCHAR;

FUNCTION GET_ACCOUNT_NAME
	(
	p_ACCOUNT_ID IN NUMBER
	) RETURN VARCHAR;

FUNCTION GET_AGGREGATE_ACCOUNT_NAME
	(
	p_AGGREGATE_ID IN NUMBER
	) RETURN VARCHAR;

FUNCTION GET_EDC_NAME
	(
	p_EDC_ID IN NUMBER
	) RETURN VARCHAR;

FUNCTION GET_ESP_NAME
	(
	p_ESP_ID IN NUMBER
	) RETURN VARCHAR;

FUNCTION GET_POOL_NAME
	(
	p_POOL_ID IN NUMBER
	) RETURN VARCHAR;

PROCEDURE GET_ACCOUNT_SERVICE_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_LOCATION_ID IN NUMBER,
	p_METER_ID IN NUMBER,
	p_AGGREGATE_ID IN NUMBER,
	p_ACCOUNT_SERVICE_ID OUT NUMBER
	);

PROCEDURE PUT_SERVICE
	(
	p_SERVICE_CODE IN CHAR,
	p_SERVICE IN SERVICE%ROWTYPE,
	p_SERVICE_ID OUT NUMBER
	);

PROCEDURE PUT_SERVICE_STATE
	(
	p_SERVICE_STATE IN SERVICE_STATE%ROWTYPE
	);

PROCEDURE GET_PROVIDER_SERVICE_ID
	(
	p_EDC_ID IN NUMBER,
	p_ESP_ID IN NUMBER,
	p_PSE_ID IN NUMBER,
	p_PROVIDER_SERVICE_ID OUT NUMBER
	);

PROCEDURE GET_PROVIDER_SERVICE_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_AGGREGATE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE,
	p_PROVIDER_SERVICE_ID OUT NUMBER
	);

FUNCTION GET_PROVIDER_SERVICE_ID
	(
	p_ACCOUNT_SERVICE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

PROCEDURE GET_ESP_PROVIDER_SERVICE_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_ESP_ID IN NUMBER,
	p_SERVICE_DATE IN DATE,
	p_PROVIDER_SERVICE_ID OUT NUMBER
	);

PROCEDURE PUT_PROCESS_STATUS
	(
	p_PROCESS_NAME IN VARCHAR,
	p_PROCESS_DATE IN DATE,
	p_AS_OF_DATE IN DATE,
	p_PROCESS_STATE IN VARCHAR,
	p_PROCESS_SYSDATE IN DATE
	);

FUNCTION GET_METER_TYPE
	(
	p_ACCOUNT_ID IN NUMBER,
	p_METER_ID IN NUMBER
	) RETURN CHAR;

FUNCTION GET_METER_MODEL_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_METER_ID IN NUMBER := NULL
	) RETURN NUMBER;

FUNCTION GET_SERVICE_POINT_ID
	(
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_LOCATION_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

FUNCTION GET_SERVICE_ZONE_ID
	(
	p_SERVICE_POINT_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_SERVICE_ID
	(
	p_MODEL_ID IN NUMBER,
	p_SCENARIO_ID IN NUMBER,
	p_AS_OF_DATE IN DATE,
	p_PROVIDER_SERVICE_ID IN NUMBER,
	p_ACCOUNT_SERVICE_ID IN NUMBER,
	p_SERVICE_DELIVERY_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_SERVICE
	(
	p_SERVICE_ID IN NUMBER
	) RETURN SERVICE%ROWTYPE;

FUNCTION GET_SERVICE_STATE
	(
	p_MODEL_ID IN NUMBER,
	p_SCENARIO_ID IN NUMBER,
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_LOCATION_ID IN NUMBER,
	p_METER_ID IN NUMBER,
	p_AGGREGATE_ID IN NUMBER,
	p_SERVICE_CODE IN CHAR,
	p_SERVICE_DATE IN DATE,
	p_AS_OF_DATE IN DATE,
	p_APPLY_UFE_CODE IN NUMBER DEFAULT 0,
	p_ESP_ID IN NUMBER DEFAULT 0,
	p_REQUESTOR IN VARCHAR DEFAULT USER
	) RETURN SERVICE_STATE%ROWTYPE;

FUNCTION GET_SERVICE_STATE
	(
	p_MODEL_ID IN NUMBER,
	p_SCENARIO_ID IN NUMBER,
	p_ACCOUNT_ID IN NUMBER,
	p_SERVICE_LOCATION_ID IN NUMBER,
	p_METER_ID IN NUMBER,
	p_AGGREGATE_ID IN NUMBER,
	p_SERVICE_CODE IN CHAR,
	p_SERVICE_DATE IN DATE,
	p_AS_OF_DATE IN DATE,
	p_EDC_ID IN NUMBER,
	p_ESP_ID IN NUMBER,
	p_PSE_ID IN NUMBER,
	p_POOL_ID IN NUMBER,
	p_APPLY_UFE_CODE IN NUMBER := 0,
	p_REQUESTOR IN VARCHAR := USER
	) RETURN SERVICE_STATE%ROWTYPE;

FUNCTION GET_PROVIDER_SERVICE_STATE
	(
	p_MODEL_ID IN NUMBER,
	p_SCENARIO_ID IN NUMBER,
	p_ACCOUNT_SERVICE_ID IN NUMBER,
	p_PROVIDER_SERVICE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE,
	p_AS_OF_DATE IN DATE
	) RETURN SERVICE_STATE%ROWTYPE;

PROCEDURE INITIALIZE_CACHE;

PROCEDURE RELEASE_CACHE;

FUNCTION GET_ESP_SUPPLY_TYPE
	(
	p_ESP_ID IN NUMBER
	) RETURN CHAR;

FUNCTION GET_PSE_IS_BUG
	(
	p_PSE_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_IS_WHOLESALE
	(
	p_SERVICE_POINT_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_IS_AGGREGATE_POOL
	(
	p_POOL_ID IN NUMBER
	) RETURN NUMBER;

FUNCTION GET_PROFILE_AS_OF_DATE
	(
	p_PROFILE_ID IN NUMBER,
	p_AS_OF_DATE IN DATE
	) RETURN DATE;

FUNCTION GET_SERVICE_DELIVERY_ID
	(
	p_POOL_ID IN NUMBER,
	p_SERVICE_POINT_ID IN NUMBER,
	p_SERVICE_ZONE_ID IN NUMBER,
	p_SCHEDULE_GROUP_ID IN NUMBER,
	p_SC_ID IN NUMBER,
	p_SUPPLY_TYPE IN CHAR,
	p_IS_BUG IN NUMBER,
	p_IS_WHOLESALE IN NUMBER,
	p_IS_AGGREGATE_POOL IN NUMBER
	) RETURN NUMBER;

PROCEDURE GET_SERVICE_DELIVERY_ID
	(
	p_ACCOUNT_SERVICE IN ACCOUNT_SERVICE%ROWTYPE,
	p_PROVIDER_SERVICE IN PROVIDER_SERVICE%ROWTYPE,
	p_SERVICE_DATE IN DATE,
	p_SERVICE_DELIVERY_ID IN OUT NUMBER
	);

PROCEDURE GET_SERVICE_DELIVERY_ID
	(
	p_ACCOUNT_SERVICE_ID IN NUMBER,
	p_PROVIDER_SERVICE_ID IN NUMBER,
	p_POOL_ID IN NUMBER,
	p_SERVICE_DATE IN DATE,
	p_SERVICE_DELIVERY_ID IN OUT NUMBER
	);

PROCEDURE GET_SERVICE_DELIVERY_ID
	(
	p_ACCOUNT_SERVICE_ID IN NUMBER,
	p_PROVIDER_SERVICE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE,
	p_SERVICE_DELIVERY_ID IN OUT NUMBER
	);

FUNCTION GET_SERVICE_DELIVERY_ID
	(
	p_ACCOUNT_SERVICE_ID IN NUMBER,
	p_PROVIDER_SERVICE_ID IN NUMBER,
	p_SERVICE_DATE IN DATE
	) RETURN NUMBER;

PROCEDURE SET_SERVICE_DELIVERY_ID
	(
	p_POOL_ID IN NUMBER,
	p_SERVICE_POINT_ID IN NUMBER,
	p_SERVICE_ZONE_ID IN NUMBER,
	p_SCHEDULE_GROUP_ID IN NUMBER,
	p_SC_ID IN NUMBER,
	p_SUPPLY_TYPE IN CHAR,
	p_IS_BUG IN NUMBER,
	p_IS_WHOLESALE IN NUMBER,
	p_IS_AGGREGATE_POOL IN NUMBER,
	p_SERVICE_DELIVERY_ID IN OUT NUMBER
	);

TYPE ESP_SUPPLY_TYPE_CACHE IS TABLE OF CHAR(1) INDEX BY BINARY_INTEGER;
g_ESP_SUPPLY_TYPE_CACHE ESP_SUPPLY_TYPE_CACHE;

TYPE PSE_IS_BUG_CACHE IS TABLE OF NUMBER(1) INDEX BY BINARY_INTEGER;
g_PSE_IS_BUG_CACHE PSE_IS_BUG_CACHE;

TYPE IS_WHOLESALE_CACHE IS TABLE OF NUMBER(1) INDEX BY BINARY_INTEGER;
g_IS_WHOLESALE_CACHE IS_WHOLESALE_CACHE;

TYPE IS_AGGREGATE_POOL_CACHE IS TABLE OF NUMBER(1) INDEX BY BINARY_INTEGER;
g_IS_AGGREGATE_POOL_CACHE IS_AGGREGATE_POOL_CACHE;

END CS;
/