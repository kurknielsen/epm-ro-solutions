CREATE OR REPLACE VIEW STATION_PARAMETER_COMPOSITE ( STATION_ID, 
PARAMETER_ID, PARAMETER_CODE, PARAMETER_DATE, PARAMETER_VAL
 ) AS SELECT A.STATION_ID, 
		B.PARAMETER_ID, 
		B.PARAMETER_CODE, 
		B.PARAMETER_DATE, 
		ROUND(SUM(B.PARAMETER_VAL * (A.COMPOSITE_PERCENT / 100.0))) "PARAMETER_VAL" 
	FROM WEATHER_STATION_COMPOSITE A, 
	    STATION_PARAMETER_VALUE B 
	WHERE B.STATION_ID = A.COMPOSITE_STATION_ID 
	GROUP BY A.STATION_ID, 
		B.PARAMETER_ID, 
		B.PARAMETER_CODE, 
		B.PARAMETER_DATE;

