CREATE OR REPLACE VIEW STATION_PARAMETER_VALUES AS
	SELECT CASE_ID,
		STATION_ID,
		PARAMETER_ID,
		PARAMETER_CODE,
		PARAMETER_DATE,
		PARAMETER_VAL
	FROM STATION_PARAMETER_VALUE
UNION ALL
	SELECT B.CASE_ID,
    	B.STATION_ID, 
		NVL(A.PARAMETER_ID, B.PARAMETER_ID) "PARAMETER_ID", 
		B.PARAMETER_CODE, 
		B.PARAMETER_DATE, 
		SUM(B.PARAMETER_VAL * (NVL(A.COMPOSITE_COEFFICIENT,1.0))) "PARAMETER_VAL" 
	FROM WEATHER_PARAMETER_COMPOSITE A, STATION_PARAMETER_VALUE B 
	WHERE B.PARAMETER_ID = A.COMPOSITE_PARAMETER_ID(+) 
	GROUP BY B.CASE_ID,
    	B.STATION_ID, 
		NVL(A.PARAMETER_ID, B.PARAMETER_ID), 
		B.PARAMETER_CODE, 
		B.PARAMETER_DATE
UNION ALL
	SELECT B.CASE_ID,
    	A.STATION_ID,
		B.PARAMETER_ID,
		B.PARAMETER_CODE,
		B.PARAMETER_DATE,
		SUM(B.PARAMETER_VAL * (A.COMPOSITE_PERCENT / 100.0)) "PARAMETER_VAL"
	FROM WEATHER_STATION_COMPOSITE A, STATION_PARAMETER_VALUE B
	WHERE B.STATION_ID = A.COMPOSITE_STATION_ID
	GROUP BY B.CASE_ID,
    	A.STATION_ID,
		B.PARAMETER_ID,
		B.PARAMETER_CODE,
		B.PARAMETER_DATE;