CREATE OR REPLACE VIEW LOAD_PROFILE_LIB_STATS_BY_S ( LIBRARY_NAME, 
PROFILE_LIBRARY_ID, PROFILE_COUNT, PROFILE_MAX, PROFILE_MIN, 
PROFILE_NZ_MIN, PROFILE_SUM, R_SQUARED_MAX, R_SQUARED_MIN, 
R_SQUARED_FAILED_MAX, R_SQUARED_FAILED_MIN, T_STAT_TEMP_MAX, T_STAT_TEMP_MIN, 
T_STAT_HUMID_MAX, T_STAT_HUMID_MIN, T_STAT_WIND_MAX, T_STAT_WIND_MIN, 
PROFILE_STATUS, VERSION_ID ) AS 
Select C.PROFILE_LIBRARY_NAME,
	   A.PROFILE_LIBRARY_ID,
	   COUNT(B.PROFILE_MAX),
	   MAX(B.PROFILE_MAX),
	   MIN(B.PROFILE_MIN),
	   MIN(B.PROFILE_NZ_MIN),
	   SUM(B.PROFILE_SUM),
	   MAX(B.R_SQUARED_MAX),
	   MIN(B.R_SQUARED_MIN),
	   MAX(B.R_SQUARED_FAIL_PCT),
	   MIN(B.R_SQUARED_FAIL_PCT),
	   MAX(B.T_STAT_TEMP_FAIL_PCT),
	   MIN(B.T_STAT_TEMP_FAIL_PCT),
	   MAX(B.T_STAT_HUMID_FAIL_PCT),
	   MIN(B.T_STAT_HUMID_FAIL_PCT),
	   MAX(B.T_STAT_WIND_FAIL_PCT),
	   MIN(B.T_STAT_WIND_FAIL_PCT),
	   B.PROFILE_STATUS,
	   B.VERSION_ID
FROM LOAD_PROFILE A,
	 LOAD_PROFILE_STATISTICS B,
	 LOAD_PROFILE_LIBRARY C
WHERE A.PROFILE_ID = B.PROFILE_ID
  AND A.PROFILE_LIBRARY_ID = C.PROFILE_LIBRARY_ID
GROUP BY C.PROFILE_LIBRARY_NAME, A.PROFILE_LIBRARY_ID, B.PROFILE_STATUS, B.VERSION_ID;
