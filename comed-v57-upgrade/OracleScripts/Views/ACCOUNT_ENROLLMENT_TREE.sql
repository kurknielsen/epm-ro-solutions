CREATE OR REPLACE VIEW ACCOUNT_ENROLLMENT_TREE ( EDC_ID, 
EDC_BEGIN_DATE, EDC_END_DATE, ESP_ID, POOL_ID, ESP_BEGIN_DATE, 
ESP_END_DATE, PSE_ID, PSE_BEGIN_DATE, PSE_END_DATE
 ) AS SELECT DISTINCT A.EDC_ID,
			A.BEGIN_DATE "EDC_BEGIN_DATE",
			A.END_DATE "EDC_END_DATE",
			B.ESP_ID,
			B.POOL_ID,
			B.BEGIN_DATE "ESP_BEGIN_DATE",
			B.END_DATE "ESP_END_DATE",
			C.PSE_ID,
			C.BEGIN_DATE "PSE_BEGIN_DATE",
			C.END_DATE "PSE_END_DATE"
		FROM ACCOUNT_EDC A,
		    AGGREGATE_ACCOUNT_ESP B,
			PSE_ESP C
		WHERE B.ACCOUNT_ID = A.ACCOUNT_ID
			AND C.ESP_ID = B.ESP_ID
		UNION
		SELECT DISTINCT A.EDC_ID,
			A.BEGIN_DATE "EDC_BEGIN_DATE",
			A.END_DATE "EDC_END_DATE",
			B.ESP_ID,
			B.POOL_ID,
			B.BEGIN_DATE "ESP_BEGIN_DATE",
			B.END_DATE "ESP_END_DATE",
			C.PSE_ID,
			C.BEGIN_DATE "PSE_BEGIN_DATE",
			C.END_DATE "PSE_END_DATE"
		FROM ACCOUNT_EDC A,
		    ACCOUNT_ESP B,
			PSE_ESP C
		WHERE B.ACCOUNT_ID = A.ACCOUNT_ID
			AND C.ESP_ID = B.ESP_ID;

