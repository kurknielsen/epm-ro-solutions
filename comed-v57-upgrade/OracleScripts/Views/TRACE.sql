CREATE OR REPLACE VIEW TRACE AS
SELECT CASE WHEN T.EVENT_TEXT IS NULL THEN T.EVENT_ERRM WHEN T.EVENT_ERRM IS NULL THEN T.EVENT_TEXT ELSE T.EVENT_TEXT||' ('||T.EVENT_ERRM||')' END AS X,
		TO_CHAR(SYSTIMESTAMP,'YYYYMMDDHH24MISSFF')||T.EVENT_ID AS I,
		CASE WHEN DBMS_SESSION.UNIQUE_SESSION_ID = L.UNIQUE_SESSION_CID THEN 1 ELSE 0 END AS CURRENT_SESSION
FROM PROCESS_LOG_TRACE T, PROCESS_LOG L
WHERE L.PROCESS_ID = T.PROCESS_ID
UNION ALL
SELECT CASE WHEN T.EVENT_TEXT IS NULL THEN T.EVENT_ERRM WHEN T.EVENT_ERRM IS NULL THEN T.EVENT_TEXT ELSE T.EVENT_TEXT||' ('||T.EVENT_ERRM||')' END AS X,
		TO_CHAR(SYSTIMESTAMP,'YYYYMMDDHH24MISSFF')||T.EVENT_ID AS I,
		1 AS CURRENT_SESSION
FROM PROCESS_LOG_TEMP_TRACE T;
