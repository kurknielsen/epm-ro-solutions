CREATE OR REPLACE VIEW PSE_BILLING_ROLLUP ( PSE_NAME, 
PSE_ID, PRODUCT_NAME, PRODUCT_ID, STATEMENT_TYPE, 
STATEMENT_MONTH, SUM_AMOUNT, IN_DISPUTE, AS_OF_DATE, COMPONENT_ID ) AS 
SELECT A.PSE_NAME,
	A.PSE_ID,
	B.PRODUCT_NAME,
	B.PRODUCT_ID,
	C.STATEMENT_TYPE,
	C.STATEMENT_DATE "STATEMENT_MONTH",
	SUM(C.CHARGE_AMOUNT) SUM_AMOUNT,
	C.IN_DISPUTE,
	C.AS_OF_DATE,
	C.COMPONENT_ID
FROM PURCHASING_SELLING_ENTITY A,
	PRODUCT B,
	BILLING_STATEMENT C
WHERE A.PSE_ID = C.ENTITY_ID
	AND B.PRODUCT_ID = C.PRODUCT_ID
GROUP BY A.PSE_NAME, A.PSE_ID, B.PRODUCT_NAME, B.PRODUCT_ID, C.STATEMENT_TYPE, C.STATEMENT_DATE, C.IN_DISPUTE, C.AS_OF_DATE, C.COMPONENT_ID;
