CREATE OR REPLACE PROCEDURE REGISTER_USER
	AUTHID CURRENT_USER
	AS

-- Revision: $Revision: 1.2 $

v_TRIGGER VARCHAR2(4000);
v_OWNER VARCHAR2(64) := APP_SCHEMA_NAME;

BEGIN
	-- create the log-on trigger
	v_TRIGGER := '
CREATE OR REPLACE TRIGGER NEA_EMO_LOGON
AFTER LOGON ON SCHEMA
BEGIN
	EXECUTE IMMEDIATE ''ALTER SESSION SET CURRENT_SCHEMA = '||v_OWNER||''';
	'||v_OWNER||'.SESSION_START;
END;
';
	EXECUTE IMMEDIATE v_TRIGGER;
  

	-- create the log-off trigger
	v_TRIGGER := '
CREATE OR REPLACE TRIGGER NEA_EMO_LOGOFF
BEFORE LOGOFF ON SCHEMA
BEGIN
	'||v_OWNER||'.SESSION_END;
END;
';
	EXECUTE IMMEDIATE v_TRIGGER;
	

	-- Done!
END REGISTER_USER;
/
