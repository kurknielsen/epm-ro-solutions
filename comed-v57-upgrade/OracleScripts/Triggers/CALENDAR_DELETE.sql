CREATE OR REPLACE TRIGGER CALENDAR_DELETE
	AFTER DELETE ON CALENDAR
	FOR EACH ROW

DECLARE
BEGIN
	IF :old.CALENDAR_ID < 100 THEN
		ERRS.RAISE(MSGCODES.c_ERR_PRIVILEGES, :old.CALENDAR_NAME || ' is a system Calendar which cannot be deleted.');
	END IF;
	DELETE CALENDAR_ADJUSTMENT WHERE CALENDAR_ID = :old.CALENDAR_ID;
	DELETE CALENDAR_PROFILE WHERE CALENDAR_ID = :old.CALENDAR_ID;
	DELETE CALENDAR_PROFILE_LIBRARY WHERE CALENDAR_ID = :old.CALENDAR_ID;
	DELETE ACCOUNT_CALENDAR WHERE CALENDAR_ID = :old.CALENDAR_ID;
	DELETE METER_CALENDAR WHERE CALENDAR_ID = :old.CALENDAR_ID;
	DELETE CALENDAR_PROJECTION WHERE CALENDAR_ID = :old.CALENDAR_ID;
END CALENDAR_DELETE;
/
