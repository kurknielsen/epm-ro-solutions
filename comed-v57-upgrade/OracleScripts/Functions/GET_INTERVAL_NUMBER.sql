CREATE OR REPLACE FUNCTION GET_INTERVAL_NUMBER
	(
	p_INTERVAL IN VARCHAR2
	)
	RETURN NUMBER IS
--Revision: $Revision: 1.6 $

--c	Return a number representing the interval.  A lower number represents a smaller interval.
--c This function can be used to compare intervals.
v_INTERVAL_ABBR VARCHAR2(4);
v_INTERVAL_NUMBER NUMBER(2);
BEGIN

	v_INTERVAL_ABBR := GET_INTERVAL_ABBREVIATION(p_INTERVAL);
	IF v_INTERVAL_ABBR = 'MI5' THEN
		v_INTERVAL_NUMBER := 5;
	ELSIF v_INTERVAL_ABBR = 'MI10' THEN
		v_INTERVAL_NUMBER := 10;
	ELSIF v_INTERVAL_ABBR = 'MI15' THEN
		v_INTERVAL_NUMBER := 15;
	ELSIF v_INTERVAL_ABBR = 'MI20' THEN
		v_INTERVAL_NUMBER := 20;
	ELSIF v_INTERVAL_ABBR = 'MI30' THEN
		v_INTERVAL_NUMBER := 25;
	ELSIF v_INTERVAL_ABBR = 'HH' OR v_INTERVAL_ABBR IS NULL THEN
		v_INTERVAL_NUMBER := 30;
	ELSIF v_INTERVAL_ABBR = 'DD' THEN
		v_INTERVAL_NUMBER := 35;
	ELSIF v_INTERVAL_ABBR = 'DY' THEN
		v_INTERVAL_NUMBER := 40;
	ELSIF v_INTERVAL_ABBR = 'MM' THEN
		v_INTERVAL_NUMBER := 45;
	ELSIF v_INTERVAL_ABBR = 'Q' THEN
		v_INTERVAL_NUMBER := 50;
	ELSIF v_INTERVAL_ABBR = 'YY' THEN
		v_INTERVAL_NUMBER := 55;
	ELSE
		v_INTERVAL_NUMBER := 30;
	END IF;
	
	RETURN v_INTERVAL_NUMBER;

	
END GET_INTERVAL_NUMBER;
/
