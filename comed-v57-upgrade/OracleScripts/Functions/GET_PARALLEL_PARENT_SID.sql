CREATE OR REPLACE FUNCTION GET_PARALLEL_PARENT_SID RETURN NUMBER IS
	v_PARENT_SID NUMBER;
BEGIN
	SELECT MAX(L.SID)
	INTO v_PARENT_SID
	FROM  v$PX_PROCESS X, v$LOCK L
	WHERE X.SID <> L.SID(+)
		AND TO_NUMBER (SUBSTR(X.SERVER_NAME,2)) = L.ID2(+)
		AND L.TYPE = 'PS'
		AND X.SID = SYS_CONTEXT('USERENV', 'SID');
	RETURN v_PARENT_SID;
END GET_PARALLEL_PARENT_SID;
/
