 
--------------------------------------------------------------------------------
START_TEST: ROI_300
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300, LOCATION_ID=10019005653, MESSAGE_DATE=28-MAR-09, MARKET_TIMESTAMP=30-MAR-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000106269579, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG2, LOAD_PROFILE_CODE=03, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010440462614 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=17-MAR-09, USAGE_FACTOR=467.29074865
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=29-MAR-09, USAGE_FACTOR=255.03210125
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00032629, METER_CATEGORY_CODE=RM043, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00032629, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=17-MAR-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=16, READING_VALUE=856, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-Z00032629, BEGIN_DATE=18-MAR-09, END_DATE=28-MAR-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=16, BILLED_DEMAND=, METERED_USAGE=16, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=18-MAR-09, READ_END_DATE=28-MAR-09
 
** USAGE_FACTORS **
METER_NAME=SN-Z00032629, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=17-MAR-09, END_DATE=28-MAR-09, PERIOD_NAME=24H, FACTOR_VAL=467.290749
METER_NAME=SN-Z00032629, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=29-MAR-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=255.032101
 
END_TEST: ROI_300
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_300_USAGE_FCTR_EXISTS
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300, LOCATION_ID=10019005653, MESSAGE_DATE=28-MAR-09, MARKET_TIMESTAMP=30-MAR-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000106269579, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG2, LOAD_PROFILE_CODE=03, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010440462614 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=17-MAR-09, USAGE_FACTOR=467.29074865
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=29-MAR-09, USAGE_FACTOR=255.03210125
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00032629, METER_CATEGORY_CODE=RM043, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00032629, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=17-MAR-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=16, READING_VALUE=856, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-Z00032629, BEGIN_DATE=18-MAR-09, END_DATE=28-MAR-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=16, BILLED_DEMAND=, METERED_USAGE=16, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=18-MAR-09, READ_END_DATE=28-MAR-09
 
** USAGE_FACTORS **
METER_NAME=SN-Z00032629, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=17-MAR-09, END_DATE=28-MAR-09, PERIOD_NAME=24H, FACTOR_VAL=467.290749
METER_NAME=SN-Z00032629, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=29-MAR-09, END_DATE=29-APR-09, PERIOD_NAME=24H, FACTOR_VAL=999999
 
END_TEST: ROI_300_USAGE_FCTR_EXISTS
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_300_2_METERS
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300, LOCATION_ID=10002273915, MESSAGE_DATE=27-MAR-09, MARKET_TIMESTAMP=30-MAR-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000106259218, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG5, LOAD_PROFILE_CODE=05, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010588689598 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=27-JAN-09, USAGE_FACTOR=4182.22158264
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-MAR-09, USAGE_FACTOR=3669.96693538
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00003911, METER_CATEGORY_CODE=RM504, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00003911, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=26-JAN-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=203, READING_VALUE=32243, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00059201, METER_CATEGORY_CODE=RM006, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00059201, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=26-JAN-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=576, READING_VALUE=30413, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-Z00003911, BEGIN_DATE=27-JAN-09, END_DATE=27-MAR-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=203, BILLED_DEMAND=, METERED_USAGE=203, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=27-JAN-09, READ_END_DATE=27-MAR-09
METER_NAME=SN-Z00059201, BEGIN_DATE=27-JAN-09, END_DATE=27-MAR-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=576, BILLED_DEMAND=, METERED_USAGE=576, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=27-JAN-09, READ_END_DATE=27-MAR-09
 
** USAGE_FACTORS **
METER_NAME=SN-Z00003911, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=27-JAN-09, END_DATE=27-MAR-09, PERIOD_NAME=24H, FACTOR_VAL=1089.847216
METER_NAME=SN-Z00003911, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=28-MAR-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=956.358521
METER_NAME=SN-Z00059201, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=27-JAN-09, END_DATE=27-MAR-09, PERIOD_NAME=24H, FACTOR_VAL=3092.374367
METER_NAME=SN-Z00059201, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=28-MAR-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=2713.608414
 
END_TEST: ROI_300_2_METERS
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_300_MULTI_USAGE_FCTR
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300, LOCATION_ID=TEST300UF, MESSAGE_DATE=01-OCT-09, MARKET_TIMESTAMP=29-OCT-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000000000123, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG2, LOAD_PROFILE_CODE=03, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=000000000123 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=01-JUN-09, USAGE_FACTOR=1000
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=02-JUN-09, USAGE_FACTOR=500
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=03-JUN-09, USAGE_FACTOR=2000
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=02-OCT-09, USAGE_FACTOR=3000
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=02-OCT-09, USAGE_FACTOR=1500
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=07-OCT-09, USAGE_FACTOR=2000
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=10-OCT-09, USAGE_FACTOR=4000
 
** TDIE_300_METER **
SERIAL_NUMBER=TESTUF1, METER_CATEGORY_CODE=RM043, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=TESTUF1, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=500, READING_VALUE=856, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=TESTUF1, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=1000, READING_VALUE=856, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-TESTUF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=500, BILLED_DEMAND=, METERED_USAGE=500, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
METER_NAME=SN-TESTUF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=1000, BILLED_DEMAND=, METERED_USAGE=1000, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
 
** USAGE_FACTORS **
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=01-MAY-09, END_DATE=31-MAY-09, PERIOD_NAME=00N, FACTOR_VAL=9999
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=01-JUN-09, END_DATE=01-JUN-09, PERIOD_NAME=00D, FACTOR_VAL=1000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=01-JUN-09, END_DATE=01-JUN-09, PERIOD_NAME=00N, FACTOR_VAL=9999
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-JUN-09, END_DATE=02-JUN-09, PERIOD_NAME=00D, FACTOR_VAL=1000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-JUN-09, END_DATE=02-JUN-09, PERIOD_NAME=00N, FACTOR_VAL=500
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=03-JUN-09, END_DATE=01-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=2000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=03-JUN-09, END_DATE=01-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=500
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=06-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=3000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=06-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=1500
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=07-OCT-09, END_DATE=09-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=3000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=07-OCT-09, END_DATE=09-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=2000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=10-OCT-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=4000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=10-OCT-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=2000
 
END_TEST: ROI_300_MULTI_USAGE_FCTR
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_300S
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300S, LOCATION_ID=10014400589, MESSAGE_DATE=15-MAR-09, MARKET_TIMESTAMP=23-MAR-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000105627793, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG2, LOAD_PROFILE_CODE=03, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010627277797 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=07-MAR-09, USAGE_FACTOR=6004.88963617
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=16-MAR-09, USAGE_FACTOR=5831.63320577
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00120817, METER_CATEGORY_CODE=RM006, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00120817, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=06-MAR-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=09, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=161, READING_VALUE=4082, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-Z00120817, BEGIN_DATE=07-MAR-09, END_DATE=15-MAR-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=161, BILLED_DEMAND=, METERED_USAGE=161, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=07-MAR-09, READ_END_DATE=15-MAR-09
 
** USAGE_FACTORS **
METER_NAME=SN-Z00120817, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=07-MAR-09, END_DATE=15-MAR-09, PERIOD_NAME=24H, FACTOR_VAL=6004.889636
METER_NAME=SN-Z00120817, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=16-MAR-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=5831.633206
 
END_TEST: ROI_300S
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_300W_NO_MATCH
 
** TDIE_MESSAGE **
***********************************************
* ERROR Processing TDIE Message: 
* No Such Entry: No matching 300/300S message for NETWORKS_REFERENCE_NUMBER=010010092760
***********************************************

MESSAGE_TYPE_CODE=300W, LOCATION_ID=10001523109, MESSAGE_DATE=05-SEP-08, MARKET_TIMESTAMP=30-MAR-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000106292416, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG5, LOAD_PROFILE_CODE=05, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010010092760 WITHDRAWAL_REASON_CODE=C1
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00002604, METER_CATEGORY_CODE=RM011, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00002604, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=08-JUL-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RWI, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=238, READING_VALUE=18768, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
 
** USAGE_FACTORS **
 
END_TEST: ROI_300W_NO_MATCH
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_300W_MULTI_USAGE_FCTR
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300, LOCATION_ID=TEST300UF, MESSAGE_DATE=01-OCT-09, MARKET_TIMESTAMP=29-OCT-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000000000123, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG2, LOAD_PROFILE_CODE=03, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=000000000123 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=01-JUN-09, USAGE_FACTOR=1000
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=02-JUN-09, USAGE_FACTOR=500
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=03-JUN-09, USAGE_FACTOR=2000
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=02-OCT-09, USAGE_FACTOR=3000
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=02-OCT-09, USAGE_FACTOR=1500
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=07-OCT-09, USAGE_FACTOR=2000
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=10-OCT-09, USAGE_FACTOR=4000
 
** TDIE_300_METER **
SERIAL_NUMBER=TESTUF1, METER_CATEGORY_CODE=RM043, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=TESTUF1, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=500, READING_VALUE=856, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=TESTUF1, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=1000, READING_VALUE=856, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=300W, LOCATION_ID=TEST300UF, MESSAGE_DATE=05-SEP-08, MARKET_TIMESTAMP=30-MAR-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000106292416, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG5, LOAD_PROFILE_CODE=05, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=000000000123 WITHDRAWAL_REASON_CODE=C1
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00002604, METER_CATEGORY_CODE=RM011, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00002604, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=08-JUL-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=01, READ_STATUS_CODE=RWI, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=238, READING_VALUE=18768, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-TESTUF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=500, BILLED_DEMAND=, METERED_USAGE=500, METERED_DEMAND=, IGNORE_CONSUMPTION=1, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
METER_NAME=SN-TESTUF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=1000, BILLED_DEMAND=, METERED_USAGE=1000, METERED_DEMAND=, IGNORE_CONSUMPTION=1, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
 
** USAGE_FACTORS **
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=01-MAY-09, END_DATE=31-MAY-09, PERIOD_NAME=00N, FACTOR_VAL=9999
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=06-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=3000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=06-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=1500
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=07-OCT-09, END_DATE=09-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=3000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=07-OCT-09, END_DATE=09-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=2000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=10-OCT-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=4000
METER_NAME=SN-TESTUF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=10-OCT-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=2000
METER_NAME=SN-TESTUF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=01-JUN-09, END_DATE=01-JUN-09, PERIOD_NAME=00D, FACTOR_VAL=1000
METER_NAME=SN-TESTUF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=01-JUN-09, END_DATE=01-JUN-09, PERIOD_NAME=00N, FACTOR_VAL=9999
METER_NAME=SN-TESTUF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-JUN-09, END_DATE=02-JUN-09, PERIOD_NAME=00D, FACTOR_VAL=1000
METER_NAME=SN-TESTUF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-JUN-09, END_DATE=02-JUN-09, PERIOD_NAME=00N, FACTOR_VAL=500
METER_NAME=SN-TESTUF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=03-JUN-09, END_DATE=01-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=2000
METER_NAME=SN-TESTUF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=03-JUN-09, END_DATE=01-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=500
 
END_TEST: ROI_300W_MULTI_USAGE_FCTR
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_320
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=320, LOCATION_ID=10005618108, MESSAGE_DATE=26-AUG-09, MARKET_TIMESTAMP=02-SEP-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000122132623, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG1, LOAD_PROFILE_CODE=02, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=MCC02, MP_BUSINESS_REFERENCE=856024679224, NETWORKS_REFERENCE_NUMBER=010550754683 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=26-AUG-09, USAGE_FACTOR=2300.77297461
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=26-AUG-09, USAGE_FACTOR=1129.93018181
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00022344, METER_CATEGORY_CODE=RM224, METER_LOCATION_CODE=02
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00022344, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=5, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=71086, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=Z00022344, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=5, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=38662, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
 
** USAGE_FACTORS **
METER_NAME=SN-Z00022344, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=26-AUG-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=2300.772975
METER_NAME=SN-Z00022344, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=26-AUG-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=1129.930182
 
END_TEST: ROI_320
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_332
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=332, LOCATION_ID=10007354676, MESSAGE_DATE=28-AUG-09, MARKET_TIMESTAMP=01-SEP-09, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000122023117, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG2, LOAD_PROFILE_CODE=04, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=MCC02, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010627362283 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=19-AUG-09, USAGE_FACTOR=7751.8542032
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=19-AUG-09, USAGE_FACTOR=5735.47581375
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-09, USAGE_FACTOR=6062.33752556
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-09, USAGE_FACTOR=3589.80556117
 
** TDIE_300_METER **
SERIAL_NUMBER=42680439, METER_CATEGORY_CODE=RM257, METER_LOCATION_CODE=20
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=42680439, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=21, READ_STATUS_CODE=, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=7, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=0, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=42680439, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=21, READ_STATUS_CODE=, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=7, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=0, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** TDIE_300_METER **
SERIAL_NUMBER=Z00007515, METER_CATEGORY_CODE=RM228, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Z00007515, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=18-AUG-09, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=22, READ_STATUS_CODE=REST, READ_TYPE_CODE=EF, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=5, POST_DECIMAL_DETAILS=0, CONSUMPTION=173, READING_VALUE=47952, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=Z00007515, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=18-AUG-09, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=22, READ_STATUS_CODE=REST, READ_TYPE_CODE=EF, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=5, POST_DECIMAL_DETAILS=0, CONSUMPTION=128, READING_VALUE=47042, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-Z00007515, BEGIN_DATE=19-AUG-09, END_DATE=28-AUG-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=173, BILLED_DEMAND=, METERED_USAGE=173, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=19-AUG-09, READ_END_DATE=28-AUG-09
METER_NAME=SN-Z00007515, BEGIN_DATE=19-AUG-09, END_DATE=28-AUG-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=128, BILLED_DEMAND=, METERED_USAGE=128, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=19-AUG-09, READ_END_DATE=28-AUG-09
 
** USAGE_FACTORS **
METER_NAME=SN-42680439, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=6062.337526
METER_NAME=SN-42680439, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=3589.805561
METER_NAME=SN-Z00007515, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=19-AUG-09, END_DATE=27-AUG-09, PERIOD_NAME=00D, FACTOR_VAL=7751.854203
METER_NAME=SN-Z00007515, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=19-AUG-09, END_DATE=27-AUG-09, PERIOD_NAME=00N, FACTOR_VAL=5735.475814
 
END_TEST: ROI_332
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_332_MULTI_NODE_TYPE
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=332, LOCATION_ID=10303981977, MESSAGE_DATE=25-SEP-08, MARKET_TIMESTAMP=13-OCT-08, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000091542244, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG5, LOAD_PROFILE_CODE=06, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=MCC02, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010469942962 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=09-JUL-08, USAGE_FACTOR=0
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=09-JUL-08, USAGE_FACTOR=0
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-08, USAGE_FACTOR=0
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-08, USAGE_FACTOR=0
 
** TDIE_300_METER **
SERIAL_NUMBER=07042004, METER_CATEGORY_CODE=RM648, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=07042004, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=25-JUL-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=16, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=0, READING_VALUE=1, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042004, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=Retained, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=2350, READING_VALUE=48, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042004, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=25-JUL-08, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=16, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=0, READING_VALUE=1, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042004, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=Retained, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=1150, READING_VALUE=24, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-07042004, BEGIN_DATE=26-JUL-08, END_DATE=28-AUG-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=0, BILLED_DEMAND=, METERED_USAGE=0, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=26-JUL-08, READ_END_DATE=28-AUG-08
METER_NAME=SN-07042004, BEGIN_DATE=26-JUL-08, END_DATE=28-AUG-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=0, BILLED_DEMAND=, METERED_USAGE=0, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=26-JUL-08, READ_END_DATE=28-AUG-08
METER_NAME=SN-07042004, BEGIN_DATE=29-AUG-08, END_DATE=25-SEP-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2350, BILLED_DEMAND=, METERED_USAGE=2350, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=29-AUG-08, READ_END_DATE=25-SEP-08
METER_NAME=SN-07042004, BEGIN_DATE=29-AUG-08, END_DATE=25-SEP-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=1150, BILLED_DEMAND=, METERED_USAGE=1150, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=29-AUG-08, READ_END_DATE=25-SEP-08
 
** USAGE_FACTORS **
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=09-JUL-08, END_DATE=27-AUG-08, PERIOD_NAME=00D, FACTOR_VAL=0
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=09-JUL-08, END_DATE=27-AUG-08, PERIOD_NAME=00N, FACTOR_VAL=0
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=0
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=0
 
END_TEST: ROI_332_MULTI_NODE_TYPE
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: ROI_332_COMPLEX
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=332, LOCATION_ID=10303981977, MESSAGE_DATE=25-SEP-08, MARKET_TIMESTAMP=13-OCT-08, RECIPIENT_ID=SA5, SENDER_ID=DSO, TX_REF_NUMBER=0000000091542244, VERSION_NUMBER=06.01.00, SUPPLIER_MPID=
 
** TDIE_300_MPRN **
DUOS_GROUP=DG5, LOAD_PROFILE_CODE=06, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=MCC02, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER=010469942962 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=26-JUL-08, USAGE_FACTOR=1136.87
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=26-JUL-08, USAGE_FACTOR=750.44
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=A, EFFECTIVE_FROM_DATE=26-JUL-08, USAGE_FACTOR=100000
TIMESLOT_CODE=00D, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-08, USAGE_FACTOR=1129
TIMESLOT_CODE=00N, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-08, USAGE_FACTOR=763
TIMESLOT_CODE=24H, USAGE_FACTOR_TYPE=E, EFFECTIVE_FROM_DATE=28-AUG-08, USAGE_FACTOR=1482
 
** TDIE_300_METER **
SERIAL_NUMBER=07042004, METER_CATEGORY_CODE=RM648, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=07042004, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=01, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=2350, READING_VALUE=48, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042004, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=25-JUL-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=16, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=1420, READING_VALUE=1, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042004, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=25-JUL-08, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=16, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=865, READING_VALUE=1, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** TDIE_300_METER **
SERIAL_NUMBER=07042005, METER_CATEGORY_CODE=RM648, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=07042005, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=1200, READING_VALUE=48, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042005, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=900, READING_VALUE=24, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** TDIE_300_METER **
SERIAL_NUMBER=07042006, METER_CATEGORY_CODE=RM648, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=07042006, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=Retained, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=001, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=02, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=2350, READING_VALUE=48, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=07042006, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=Retained, UOM_CODE=KWH, PREVIOUS_READ_DATE=28-AUG-08, METER_REGISTER_SEQUENCE=002, READ_REASON_CODE=09, READ_STATUS_CODE=REST, READ_TYPE_CODE=E, REGISTER_TYPE_CODE=03, METER_MULTIPLIER=50, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=1150, READING_VALUE=24, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-07042004, BEGIN_DATE=26-JUL-08, END_DATE=25-SEP-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=1420, BILLED_DEMAND=, METERED_USAGE=1420, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=26-JUL-08, READ_END_DATE=25-SEP-08
METER_NAME=SN-07042004, BEGIN_DATE=26-JUL-08, END_DATE=25-SEP-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=865, BILLED_DEMAND=, METERED_USAGE=865, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=26-JUL-08, READ_END_DATE=25-SEP-08
METER_NAME=SN-07042006, BEGIN_DATE=29-AUG-08, END_DATE=25-SEP-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2350, BILLED_DEMAND=, METERED_USAGE=2350, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=29-AUG-08, READ_END_DATE=25-SEP-08
METER_NAME=SN-07042006, BEGIN_DATE=29-AUG-08, END_DATE=25-SEP-08, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=1150, BILLED_DEMAND=, METERED_USAGE=1150, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=29-AUG-08, READ_END_DATE=25-SEP-08
 
** USAGE_FACTORS **
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=26-JUL-08, END_DATE=27-AUG-08, PERIOD_NAME=00D, FACTOR_VAL=428.210981
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=26-JUL-08, END_DATE=27-AUG-08, PERIOD_NAME=00N, FACTOR_VAL=322.149181
METER_NAME=SN-07042004, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=1482
METER_NAME=SN-07042005, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=381.633803
METER_NAME=SN-07042005, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=334.97561
METER_NAME=SN-07042006, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=26-JUL-08, END_DATE=27-AUG-08, PERIOD_NAME=00D, FACTOR_VAL=708.659019
METER_NAME=SN-07042006, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=26-JUL-08, END_DATE=27-AUG-08, PERIOD_NAME=00N, FACTOR_VAL=428.290819
METER_NAME=SN-07042006, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=747.366197
METER_NAME=SN-07042006, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=28-AUG-08, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=428.02439
 
END_TEST: ROI_332_COMPLEX
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: NIE_300
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=N300, LOCATION_ID=TESTN300UF, MESSAGE_DATE=01-OCT-09, MARKET_TIMESTAMP=05-JUL-09, RECIPIENT_ID=NIE, SENDER_ID=TDM, TX_REF_NUMBER=000083641507, VERSION_NUMBER=00.02.03, SUPPLIER_MPID=TDO
 
** TDIE_300_MPRN **
DUOS_GROUP=T031, LOAD_PROFILE_CODE=, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER= WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=N300UF1, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N300UF1, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=2180, READING_VALUE=46060, ANNUALISED_ACTUAL_CONSUMPTION=19056.943546, ESTIMATED_USAGE_FACTOR=9999
SERIAL_NUMBER=N300UF1, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=2, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=2180, READING_VALUE=46060, ANNUALISED_ACTUAL_CONSUMPTION=19056.943546, ESTIMATED_USAGE_FACTOR=1111
 
** TDIE_300_METER **
SERIAL_NUMBER=N300UF2, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N300UF2, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=2180, READING_VALUE=46060, ANNUALISED_ACTUAL_CONSUMPTION=19056.943546, ESTIMATED_USAGE_FACTOR=8888
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-N300UF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2180, BILLED_DEMAND=, METERED_USAGE=2180, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
METER_NAME=SN-N300UF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2180, BILLED_DEMAND=, METERED_USAGE=2180, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
METER_NAME=SN-N300UF2, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2180, BILLED_DEMAND=, METERED_USAGE=2180, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
 
** USAGE_FACTORS **
METER_NAME=SN-N300UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=9999
METER_NAME=SN-N300UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=1111
METER_NAME=SN-N300UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=9999
METER_NAME=SN-N300UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=1111
METER_NAME=SN-N300UF2, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, PERIOD_NAME=24H, FACTOR_VAL=8888
METER_NAME=SN-N300UF2, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=8888
 
END_TEST: NIE_300
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: NIE_300S
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=N300S, LOCATION_ID=Acc123, MESSAGE_DATE=26-JUN-07, MARKET_TIMESTAMP=27-JUN-07, RECIPIENT_ID=NIE, SENDER_ID=TDM, TX_REF_NUMBER=803538792526, VERSION_NUMBER=00.02.03, SUPPLIER_MPID=TDO
 
** TDIE_300_MPRN **
DUOS_GROUP=DG3, LOAD_PROFILE_CODE=, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER= WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=Acc123, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=Acc123, TIMESLOT_CODE=UNR, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=31-MAY-07, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=02, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=128, READING_VALUE=11655, ANNUALISED_ACTUAL_CONSUMPTION=1080.914145, ESTIMATED_USAGE_FACTOR=784.222948
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-Acc123, BEGIN_DATE=01-JUN-07, END_DATE=26-JUN-07, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=UNR, PERIOD_NAME=UNR, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=128, BILLED_DEMAND=, METERED_USAGE=128, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=01-JUN-07, READ_END_DATE=26-JUN-07
 
** USAGE_FACTORS **
METER_NAME=SN-Acc123, CASE_NAME=Base, TEMPLATE_NAME=UNR, BEGIN_DATE=01-JUN-07, END_DATE=26-JUN-07, PERIOD_NAME=UNR, FACTOR_VAL=784.222948
METER_NAME=SN-Acc123, CASE_NAME=Base, TEMPLATE_NAME=UNR, BEGIN_DATE=27-JUN-07, END_DATE=, PERIOD_NAME=UNR, FACTOR_VAL=784.222948
 
END_TEST: NIE_300S
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: TEST_NIE_300W
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=N300, LOCATION_ID=TESTN300UF, MESSAGE_DATE=01-OCT-09, MARKET_TIMESTAMP=05-JUL-09, RECIPIENT_ID=NIE, SENDER_ID=TDM, TX_REF_NUMBER=000083641507, VERSION_NUMBER=00.02.03, SUPPLIER_MPID=TDO
 
** TDIE_300_MPRN **
DUOS_GROUP=T031, LOAD_PROFILE_CODE=, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER= WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=N300UF1, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N300UF1, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=2180, READING_VALUE=46060, ANNUALISED_ACTUAL_CONSUMPTION=19056.943546, ESTIMATED_USAGE_FACTOR=9999
SERIAL_NUMBER=N300UF1, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=2, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=2180, READING_VALUE=46060, ANNUALISED_ACTUAL_CONSUMPTION=19056.943546, ESTIMATED_USAGE_FACTOR=1111
 
** TDIE_300_METER **
SERIAL_NUMBER=N300UF2, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N300UF2, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=01-SEP-09, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=2180, READING_VALUE=46060, ANNUALISED_ACTUAL_CONSUMPTION=19056.943546, ESTIMATED_USAGE_FACTOR=8888
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=N300W, LOCATION_ID=TESTN300UF, MESSAGE_DATE=01-OCT-09, MARKET_TIMESTAMP=24-JUL-07, RECIPIENT_ID=NIE, SENDER_ID=TDM, TX_REF_NUMBER=417586122239, VERSION_NUMBER=00.02.03, SUPPLIER_MPID=TDO
 
** TDIE_300_MPRN **
DUOS_GROUP=T014, LOAD_PROFILE_CODE=, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=, MP_BUSINESS_REFERENCE=, NETWORKS_REFERENCE_NUMBER= WITHDRAWAL_REASON_CODE=C2
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=N300UF1, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N300UF1, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=154, READING_VALUE=66016, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
SERIAL_NUMBER=N300UF1, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=2, READ_REASON_CODE=01, READ_STATUS_CODE=RV, READ_TYPE_CODE=A, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=, POST_DECIMAL_DETAILS=, CONSUMPTION=154, READING_VALUE=66016, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-N300UF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00D, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2180, BILLED_DEMAND=, METERED_USAGE=2180, METERED_DEMAND=, IGNORE_CONSUMPTION=1, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
METER_NAME=SN-N300UF1, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night, PERIOD_NAME=00N, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2180, BILLED_DEMAND=, METERED_USAGE=2180, METERED_DEMAND=, IGNORE_CONSUMPTION=1, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
METER_NAME=SN-N300UF2, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D 24H, PERIOD_NAME=24H, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=2180, BILLED_DEMAND=, METERED_USAGE=2180, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=02-SEP-09, READ_END_DATE=01-OCT-09
 
** USAGE_FACTORS **
METER_NAME=SN-N300UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=9999
METER_NAME=SN-N300UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=1111
METER_NAME=SN-N300UF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, PERIOD_NAME=00D, FACTOR_VAL=9999
METER_NAME=SN-N300UF1, CASE_NAME=Withdrawn, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, PERIOD_NAME=00N, FACTOR_VAL=1111
METER_NAME=SN-N300UF2, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=02-SEP-09, END_DATE=01-OCT-09, PERIOD_NAME=24H, FACTOR_VAL=8888
METER_NAME=SN-N300UF2, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=8888
 
END_TEST: TEST_NIE_300W
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: NIE_320
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=N320, LOCATION_ID=TESTN320UF, MESSAGE_DATE=01-OCT-09, MARKET_TIMESTAMP=05-JUL-09, RECIPIENT_ID=NIE, SENDER_ID=TDM, TX_REF_NUMBER=000083641507, VERSION_NUMBER=00.02.03, SUPPLIER_MPID=TDO
 
** TDIE_300_MPRN **
DUOS_GROUP=T014, LOAD_PROFILE_CODE=802, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=N002, MP_BUSINESS_REFERENCE=7802142871, NETWORKS_REFERENCE_NUMBER=184961436252 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=N320UF1, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N320UF1, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=130012, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=5555
SERIAL_NUMBER=N320UF1, TIMESLOT_CODE=24H, REGISTER_NODE_TYPE=?, UOM_CODE=KWT, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=2, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=130012, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=5555
 
** TDIE_300_METER **
SERIAL_NUMBER=N320UF2, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=N320UF2, TIMESLOT_CODE=00D, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=1, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=130012, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=4444
SERIAL_NUMBER=N320UF2, TIMESLOT_CODE=00N, REGISTER_NODE_TYPE=?, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=2, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=130012, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=3333
 
** SERVICE_CONSUMPTION **
 
** USAGE_FACTORS **
METER_NAME=SN-N320UF1, CASE_NAME=Base, TEMPLATE_NAME=IE T&D 24H, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=24H, FACTOR_VAL=5555
METER_NAME=SN-N320UF2, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=00D, FACTOR_VAL=4444
METER_NAME=SN-N320UF2, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night, BEGIN_DATE=02-OCT-09, END_DATE=, PERIOD_NAME=00N, FACTOR_VAL=3333
 
END_TEST: NIE_320
--------------------------------------------------------------------------------
 
 
--------------------------------------------------------------------------------
START_TEST: NIE_332
 
** TDIE_MESSAGE **
VALID!
MESSAGE_TYPE_CODE=N332, LOCATION_ID=82798932092, MESSAGE_DATE=25-JUN-07, MARKET_TIMESTAMP=26-JUN-07, RECIPIENT_ID=NIE, SENDER_ID=TDM, TX_REF_NUMBER=027211403213, VERSION_NUMBER=00.02.03, SUPPLIER_MPID=TDO
 
** TDIE_300_MPRN **
DUOS_GROUP=T014, LOAD_PROFILE_CODE=802, METER_POINT_STATUS_CODE=E, METER_CONFIGURATION_CODE=N002, MP_BUSINESS_REFERENCE=7802142871, NETWORKS_REFERENCE_NUMBER=184961436252 WITHDRAWAL_REASON_CODE=
 
** TDIE_USAGE_FACTOR **
 
** TDIE_300_METER **
SERIAL_NUMBER=93P8375, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=93P8375, TIMESLOT_CODE=D01, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=6, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=130012, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=0
SERIAL_NUMBER=93P8375, TIMESLOT_CODE=N01, REGISTER_NODE_TYPE=New, UOM_CODE=KWH, PREVIOUS_READ_DATE=, METER_REGISTER_SEQUENCE=7, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=6, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=68270, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=900
 
** TDIE_300_METER **
SERIAL_NUMBER=YB50626, METER_CATEGORY_CODE=, METER_LOCATION_CODE=
 
** TDIE_300_REGISTER **
SERIAL_NUMBER=YB50626, TIMESLOT_CODE=N01, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=29-APR-07, METER_REGISTER_SEQUENCE=8, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=5, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=9892, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=1512
SERIAL_NUMBER=YB50626, TIMESLOT_CODE=D01, REGISTER_NODE_TYPE=Removed, UOM_CODE=KWH, PREVIOUS_READ_DATE=29-APR-07, METER_REGISTER_SEQUENCE=9, READ_REASON_CODE=26, READ_STATUS_CODE=, READ_TYPE_CODE=CU, REGISTER_TYPE_CODE=IS, METER_MULTIPLIER=1, PRE_DECIMAL_DETAILS=5, POST_DECIMAL_DETAILS=0, CONSUMPTION=, READING_VALUE=32200, ANNUALISED_ACTUAL_CONSUMPTION=, ESTIMATED_USAGE_FACTOR=2060
 
** SERVICE_CONSUMPTION **
METER_NAME=SN-YB50626, BEGIN_DATE=30-APR-07, END_DATE=25-JUN-07, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night NIE, PERIOD_NAME=D01, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=, BILLED_DEMAND=, METERED_USAGE=, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=30-APR-07, READ_END_DATE=25-JUN-07
METER_NAME=SN-YB50626, BEGIN_DATE=30-APR-07, END_DATE=25-JUN-07, BILL_CODE=B, CONSUMPTION_CODE=A, TEMPLATE_NAME=IE T&D Day/Night NIE, PERIOD_NAME=N01, UNIT_OF_MEASUREMENT=KWH, METER_TYPE=P, BILLED_USAGE=, BILLED_DEMAND=, METERED_USAGE=, METERED_DEMAND=, IGNORE_CONSUMPTION=0, READ_BEGIN_DATE=30-APR-07, READ_END_DATE=25-JUN-07
 
** USAGE_FACTORS **
METER_NAME=SN-93P8375, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night NIE, BEGIN_DATE=26-JUN-07, END_DATE=, PERIOD_NAME=D01, FACTOR_VAL=0
METER_NAME=SN-93P8375, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night NIE, BEGIN_DATE=26-JUN-07, END_DATE=, PERIOD_NAME=N01, FACTOR_VAL=900
METER_NAME=SN-YB50626, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night NIE, BEGIN_DATE=30-APR-07, END_DATE=25-JUN-07, PERIOD_NAME=D01, FACTOR_VAL=2060
METER_NAME=SN-YB50626, CASE_NAME=Base, TEMPLATE_NAME=IE T&D Day/Night NIE, BEGIN_DATE=30-APR-07, END_DATE=25-JUN-07, PERIOD_NAME=N01, FACTOR_VAL=1512
 
END_TEST: NIE_332
--------------------------------------------------------------------------------
 
