DECLARE 

	PROCEDURE CREATE_SC_EDC_PAIR
	(
		p_NAME IN VARCHAR2,
		p_DESC IN VARCHAR2,
		p_SCHEDULE_INTERVAL IN VARCHAR2,
        p_EXTERNAL_IDENTIFIER IN VARCHAR2 := NULL
	) AS
	
		v_SC_ID NUMBER(9);
		v_EDC_ID NUMBER(9);
	
	BEGIN
		v_SC_ID := EI.GET_ID_FROM_ALIAS(p_NAME, EC.ED_SC, 1);
	
		IF v_SC_ID IS NULL THEN
			IO.PUT_SC(v_SC_ID, -- OUT ID
					p_NAME, -- NAME
					p_NAME, -- ALIAS
					p_DESC, -- DESC
					0, -- CREATE NEW
					NULL, -- NERC CODE
					NULL, -- DUNS_NUMBER
					'Active', -- SC_STATUS
					p_NAME, -- EXTERNAL_IDENTIFIER
					NULL, -- SCHEDULE_NAME_PREFIX
					'Schedule Group', -- SCHEDULE_FORMAT
					p_SCHEDULE_INTERVAL, -- SCHEDULE_INTERVAL
					'Round Standard', -- LOAD_ROUNDING_PREF
					'Round Standard', -- LOSS_ROUNDING_PREF
					0, -- CREATE_TX_LOSS_SCHEDULE
					0, -- CREATE_DX_LOSS_SCHEDULE
					0, -- CREATE_UFE_SCHEDULE
					NULL, -- MARKET_PRICE_ID
					-99999.999); -- MINIMUM_SCHEDULE_AMT
		END IF;
						
		EM.PUT_EXTERNAL_SYSTEM_IDENTIFIER(EC.ES_TDIE, EC.ED_SC, v_SC_ID, EI.g_DEFAULT_IDENTIFIER_TYPE, p_NAME,
			EI.g_DEFAULT_IDENTIFIER_TYPE);
		
		v_EDC_ID := EI.GET_ID_FROM_ALIAS(p_NAME, EC.ED_EDC, 1);
		
		IF v_EDC_ID IS NULL THEN		
			IO.PUT_EDC(v_EDC_ID, -- OUT_ID
					p_NAME, -- NAME
					p_NAME, -- ALIAS
					p_DESC, -- DESC
					0, -- EDC_ID
					'Active', -- STATUS
					NULL, -- DUNS_NUMBER,
					p_NAME, -- EXTERNAL_IDENTIFIER
					NULL, -- SETTLEMENT_AGENT_NAME
					'Account', -- LOSS_FACTOR_OPTION
					NULL, -- SYSTEM_LOAD_ID
					NULL, -- MARKET_PRICE_ID
					0, -- HOLIDAY_SET_ID
					v_SC_ID, -- SC_ID
					0); -- EXCLUDE_LOAD_SCHEDULE
		END IF;
		
		EM.PUT_EXTERNAL_SYSTEM_IDENTIFIER(EC.ES_TDIE, EC.ED_EDC, v_EDC_ID, EI.g_DEFAULT_IDENTIFIER_TYPE, NVL(p_EXTERNAL_IDENTIFIER, p_NAME),
			EI.g_DEFAULT_IDENTIFIER_TYPE);
	 
	END CREATE_SC_EDC_PAIR;
	
	PROCEDURE CREATE_PSE(p_NAME IN VARCHAR2,p_DESC IN VARCHAR2,p_INVOICE_TYPE IN VARCHAR2 := NULL,p_EXTERNAL_IDENTIFIER IN VARCHAR2 := NULL) AS
		v_PSE_ID NUMBER(9);
	BEGIN
		v_PSE_ID := EI.GET_ID_FROM_ALIAS(p_NAME, EC.ED_PSE, 1);
		IF v_PSE_ID IS NULL THEN
			IO.PUT_PSE(v_PSE_ID,
				p_NAME,
				p_NAME,
				p_DESC,
				0,
				NULL, --PSE_NERC_CODE
				'Active', --PSE_STATUS
				NULL, --PSE_DUNS_NUMBER
				NULL, --PSE_BANK
				NULL, --PSE_ACH_NUMBER
				'Utility', --PSE_TYPE
				p_NAME, --PSE_EXTERNAL_IDENTIFIER
				0, --PSE_IS_RETAIL_AGGREGATOR
				0, --PSE_IS_BACKUP_GENERATION
				0, --PSE_EXCLUDE_LOAD_SCHEDULE
				0, --IS_BILLING_ENTITY
				'EDT', -- TIME_ZONE
				NULL, --STATEMENT_INTERVAL
				NULL, --INVOICE_INTERVAL
				NULL, --WEEK_BEGIN
				NULL, --INVOICE_LINE_ITEM_OPTION
				NULL, --INVOICE_EMAIL_SUBJECT
				NULL, --INVOICE_EMAIL_PRIORITY
				NULL, --INVOICE_EMAIL_BODY
				NULL, --INVOICE_EMAIL_BODY_MIME_TYPE
				NULL, --SCHEDULE_NAME_PREFIX
				NULL, --SCHEDULE_FORMAT
				NULL, --SCHEDULE_INTERVAL
				NULL, --LOAD_ROUNDING_PREFERENCE
				NULL, --LOSS_ROUNDING_PREFERENCE
				NULL, --CREATE_TX_LOSS_SCHEDULE
				NULL, --CREATE_DX_LOSS_SCHEDULE
				NULL, --CREATE_UFE_SCHEDULE
				NULL  --MINIMUM_SCHEDULE_AMT
				);
		END IF;
		
        IF p_INVOICE_TYPE IS NOT NULL THEN
            EM.PUT_EXTERNAL_SYSTEM_IDENTIFIER(EC.ES_TDIE, EC.ED_PSE, v_PSE_ID, p_INVOICE_TYPE, NVL(p_EXTERNAL_IDENTIFIER, p_NAME),
                        p_INVOICE_TYPE);
        END IF;

	END CREATE_PSE;

BEGIN
	CREATE_SC_EDC_PAIR('ESBN', 'ESBN -- ROI T' || CONSTANTS.AMPERSAND || 'D', '15 Minute');
	CREATE_SC_EDC_PAIR('NIE', 'NIE -- NI T' || CONSTANTS.AMPERSAND || 'D', '30 Minute');
	
	CREATE_PSE('EirGrid', 'EirGrid -- ROI TUoS Sender','TUOS');
	CREATE_PSE('SONI', 'SONI -- NI TUoS Sender','UOS');
	CREATE_PSE('DSO', 'DSO -- ROI DUoS Sender (ESBN)','DUOS');
	CREATE_PSE('NIE T' || CONSTANTS.AMPERSAND || 'D', 'NIE T' || CONSTANTS.AMPERSAND || 'D -- NI DUoS Sender','UOS');
	EM.PUT_EXTERNAL_SYSTEM_IDENTIFIER(EC.ES_TDIE, EC.ED_PSE, EI.GET_ID_FROM_ALIAS('NIE T' || CONSTANTS.AMPERSAND || 'D', EC.ED_PSE, 1), 
												'DUOS NI', 'TDO' , 'DUOS NI');
    CREATE_PSE('PSO (NI)', 'Public Service Obligation - NI','PSO');
    CREATE_PSE('PSO (ROI)', 'Public Service Obligation - ROI','PSO');
    CREATE_PSE('CCL', 'Climate Change Levee','CCL');
    CREATE_PSE('SSS', 'System Support Services','SSS');
END;
/
